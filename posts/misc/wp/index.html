<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Wp | Modest&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="ctfshow的图片类题目">
<meta name="author" content="Modest">
<link rel="canonical" href="https://modesty258.github.io/posts/misc/wp/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://modesty258.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://modesty258.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://modesty258.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://modesty258.github.io/img/Q.gif">
<link rel="mask-icon" href="https://modesty258.github.io/img/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta property="og:title" content="Wp" />
<meta property="og:description" content="ctfshow的图片类题目" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://modesty258.github.io/posts/misc/wp/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-07T20:05:06+08:00" />
<meta property="article:modified_time" content="2023-05-07T20:05:06+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Wp"/>
<meta name="twitter:description" content="ctfshow的图片类题目"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "📚文章",
          "item": "https://modesty258.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "📚misc",
          "item": "https://modesty258.github.io/posts/misc/"
        }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Wp",
      "item": "https://modesty258.github.io/posts/misc/wp/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Wp",
  "name": "Wp",
  "description": "ctfshow的图片类题目",
  "keywords": [
    ""
  ],
  "articleBody": "umi-ocr图片提取工具\nmisc1 解压就行\nmisc2 解压一个文本文件，然后打开都是乱码，打开010看一下\n开头就是89 50可以知道了这是一个png文件，然后改为了txt后缀，把后缀改回来就可以了\nmisc3 解压完发现是一个bpg文件，没有什么技巧，直接查看就行了\nmisc4 这道题解压后有6个txt文件，和第二题一样，这道题也是文件后缀，只不过是6个，一个一个改了在进行拼接就行了\nmisc5 打开后显示flag不在这里，仔细找了下，在010中可以找到\nmisc6 和上一道题目一样，只不过不在结尾了，在中间，需要仔细找找\nmisc7 和上一道一样，需要搜一下\nmisc8 题目说在图片文件中，但是实在肉眼找不到，尝试用txt后缀，但是看不到，这时候使用到了binwalk等分离工具\nbinwalk看到文件其实还含有一张png文件，利用foremost分离\n文件就直接出来了，flag就在文件里面\nmisc9 看不懂，我出的时候感觉还是炒冷饭\nmisc10 找了找没找到，直接分离出来了，感觉还是炒冷饭\nmisc11 flag在另一张图，很明显的提示，用binwalk看了一眼，只有一个图片文件，还有一个bzip2文件，不知道该怎么处理\ntweakpng Irfanview图片隐写术 在杂项中，经常会遇到图片被修改，可能是尺寸，也有可能是其他的，但是默认的图片编辑器不会报错，但是专业的文件编辑器会报错，比如上面的两个，\n常见错误 crc错误\n这里有两种可能\n1）图片CRC被修改 可以尝试用十六进制编辑器打开图片，修改CRC。\n2）图片尺寸被修改 这时候就要用十六进制编辑器修改图片尺寸了。\n解决 对于还原尺寸，可以利用蒙一下，也可以用个脚本\nimport os import binascii import struct crcbp = open(\"xxx.png\", \"rb\").read() #打开图片 for i in range(2000): for j in range(2000): data = crcbp[12:16] + \\ struct.pack('\u003ei', i)+struct.pack('\u003ei', j)+crcbp[24:29] crc32 = binascii.crc32(data) \u0026 0xffffffff if(crc32 == 0x38162a34): #图片当前CRC print(i, j) print('hex:', hex(i), hex(j)) 使用时修改脚本中的打开图片名称和图片当前CRC\n然后在图片所在目录运行Python脚本\n再用010改一下就可以了\ntweakpng idat 当然这一题用的不是上面的，需要用到这个文件\n使用tweakpng打开文件，发现有两个idat文件头，这就说明有问题，\n默认的图片是以第一个idat块来显示，所以将下面的移上去，或者把第一个删除就可以了\n虽然不知道什么原理，将上面的删除了就会显示下面的idat数据头，可能是因为每个idat都对应一个图片，所以只能换一下，或者将下面的移到上面\nmisc12 和上一题一样，有很多idat块，只不过不知道哪一个才是，但是肯定知道最上面的不是，所以一个一个的删除，肯定有一个是\n在删除的过程中，发现中间的几个都是无效的，删到第八个的时候就出来了正确的\nmisc13 flag位置在图片末尾。\n打开010，能看出来图片中含有flag，但是被编码了\n分离了一下，里面估计没有txt文件了，还是尝试解码\nct¹f…s†hªoKw°{!aeS6¥eT446xc%4Ý8ïf«73•9b‚7ºeEb|2Td~1:däeñ6úeõ412fT8ñ329éal} 不是base，仔细一看，根本就没有编码，只是每两个之间用一个特殊字符隔开了，尝试用python来跑个脚本\na=\"c\u001at¹f…s†hªoKw°{!a\u0014eS6¥eT446xc%4Ý8ïf«7\u00103•9\u001fb‚7ºeEb|2Td~1:däeñ6úeõ4\u001e1\u00072\u001dfT8ñ329éal}\" flag=\"\" for i in range(0,len(a),2): hexStr=a[i] flag+=hexStr print(flag) ctfshow{ae6e46c48f739b7eb2d1de6e412f839a}\nctfshow{ae6e3ea48f518b7e42d7de6f412f839a}\nmisc14 dd 文件分离 binwalk分析一下，发现有两个文件，直接分离\n临时学习了个dd指令，用来分离文件：\ndd if=misc14.jpg of=1.png skip=2103 bs=1 if代表输入文件，of代表输出文件，skip代表跳过到多少个块后开始（binwalk可以看到），bs是代表字节为单位的块的大小，参数还有很多，目前先记住这几个就能分出图片了。\n这里由于binwalk查看到在2103个块开始还有一个JPEG文件，那就直接shkip到2103开始分离。\n成功得到flag。\n解法二 从binwalk可以看到里面有两个jpg文件，可以直接用010将另一个文件直接从里面提取出来，直接找到文件头FF D8，第三个就是我们需要的，直接复制出来生成一个新的文件就可以了\nmisc15 是一个bmp文件，拿binwalk分析了以下没看见啥有用的。\n直接搜，拿010\nmisc16 binwalk扫一下，发下确实有点东西，但是不懂，不像之前有图片文本来得那么直接\n诶，怎么说呢，有时候可能不一定没有txt就没有文本，可以用binwalk直接分离出来一个dd4，没错，就是他\nbinwalk tip 怎么说呢，以后遇见题目，即使没有你认识的文件，也要尝试分离一下，分离不出来就用foremost或者dd，或者其他的一些，总而言之只要里面不是一个文件，就分离出来再继续做\nzsteg 检测隐写 zsteg可以检测PNG和BMP图片里的隐写数据。\n目前，zsteg支持检测：\nPNG 和 BMP 格式的 LSB 隐写术 zlib 压缩数据 打开Stego Camouflage 1.2.1 LSB 还是转到分离工具去看用法吧\n这里先浅浅的使用一下\nmisc17 直接分析，里面还有一个bzip2\n因为直接用分离工具提取会将文件损坏，所以只好用zsteg工具\n直接用zsteg看一下隐藏文件，看到了16进制，但是并没有flag，\n直接用zsteg将隐藏文件提取到一个1.txt当中，打开再看，发现是乱码，再用binwalk分离一下就有了\n看了一下wp，发现当时用zsteg检测出来的extradata:0 ，是在这个里面存在隐藏数据，所以应该将这个文件给提取出来，所以就有了对应的命令 zsteg -E “extradata:0” misc17.png \u003e 1.txt\nmisc18 看题目要求就知道了，在图片的属性里面，就是不知道010能不能看出来试试\n嗯，010是有的，但是有一点，他得拼接，我认为还是属性方便\nctfshow{325d60c208f728ac17e5f02d4cf5a839}\nmisc19 ctfshow{dfdcf08038cd446a5eb50782f8d3605d}\n怎么说呢，属性不一定能找到，但是010一定可以找到\nexiftool简介 查看图片简介 这个软件能扫出来图片的作者，等属性信息，主机，评论什么的也可以直接显示出来，以后可以直接看一眼\n命令\nexiftool flie_name misc20 直接用exiftool找出来了图片的所有信息，基本有了\n这图片也太难看了。来自：西替爱抚秀大括号西九七九六四必一诶易西爱抚零六易一弟七九西二一弟弟诶弟五九三易四二大括号\n很显然了，这就是flag\nctfshow{c97964b1aecf06e1d79c21ddad593e42}\nmisc21 题目说是看序号，打开010看了一看，大概有思路了，首先题目给出了，在010中也看到了数字，应该是某种加密，再不济也是一个ascil\n然后用exif工具扫了一下，看到了编码方式Baseline DCT, Huffman coding就是霍夫曼编码，先复制出来，再解一下就ok了\nX Resolution: 3902939465 0xe8a22149 Y Resolution: 2371618619 0x8d5c073b X Position: 1082452817 0x4084eb51 Y Position: 2980145261 0xb1a1686d Serial Number: 686578285826597329 先把Serial Number进行进制转换，使用16进制转换到文本字符串，得到hex(X\u0026Ys)，经查询，他的意思是将下x，y的十进制转化为16进制，所以直接转就可以了\npython直接运行就可以了\ne8a221498d5c073b4084eb51b1a1686d，再套上壳\nmisc22 还是用exif扫了一下，找到了需要的东西，就是这个Binary data 18195 bytes, use -b option to extract\n看到这个是不是莫名的熟悉\n好吧，我放弃了\n根据这个就可以把他用zsteg给提出去，很神奇\nmisc23 很好，psd文件，不知道是啥，搜一哈，Photoshop\n算了，还是用exif吧\nctfshow{49520599-6932-e144-8f4b-dfd5873be5bc}\n嘻嘻嘻，出了，美美提交，焯，错了，好难的样子\n发现给的这一堆逼数没一点用，还是大佬wp\n时间戳 1997:09:22 02:17:02+08:00 874865822 3425649e\n2055:07:15 12:14:48+08:00\n2038:05:05 16:50:45+08:00\n1984:08:03 18:41:46+08:00\n利用在线网站转换一下，再转换成16进制，出来的就是了\nmisc41 文件结构 从这里开始，就来到一个新的篇章了，属于文件结构，就需要修改长宽高来判断了\nmisc24 flag在图片上面，就说明这个图片的高度不够，需要修改高度\n通过图片的数据块可以知道图片的宽高在哪里修改，只需要修改高度就可以出来了\n将高度处的96改为FA就可以得出来了\nmisc25 首先，这时候最好用kali或者tweakpng打开文件，因为这种隐藏宽高的图片一般是看不出来修改的痕迹，专业工具会更好看出来，比如这一个，就是一个crc的错误，在上面的misc11有，直接还原就可以了\n修改高度的话可以和上一题一样，就可以得到flag了\nmisc26 这个说在多下面，我管你多下面，我直接改成FA(250)，你还能有多下面,好吧，真的比这个还下面，我只好改为56ce(22222)了，出了，但是没有完全出\ncftshow{94aef1+True height(hex) of this picture+087a7ccf2e28e742efd704c} 这一道题需要得到正确的高度并且结合得到flag，出题人，你是个狠人呀。\n这时候就得上脚本跑出来正确的高度了\nimport os import binascii import struct crcbp = open(\"misc26.png\", \"rb\").read() #打开图片 for i in range(2000): for j in range(2000): data = crcbp[12:16] + \\ struct.pack('\u003ei', i)+struct.pack('\u003ei', j)+crcbp[24:29] crc32 = binascii.crc32(data) \u0026 0xffffffff if(crc32 == 0xEC9CCBC6): #图片当前CRC print(i, j) print('hex:', hex(i), hex(j)) 先找到crc32值\n这个是在图片的后面，先把5个字节跳过去，然后后面的4个字节就是就是crc32的值，带进去爆破出来就可以了。\n然后再代入hex函数\nmisc27 答案在图片下面，那还是老规矩呗，直接打开宽高位修改图片，但是发现宽高位的不是宽高，这就要利用到我们的搜索能力了，打开图片属性，将图片的宽高转化为16进制，然后再010里面搜索，就可以很轻易的搜到了，然后再将图片的高改为和宽一样，flag就出来了，当然这个高度随便改，能把下面的flag给显示出来就可以了\ngif 文件头部分(Header) GIF署名和版本号 GIf署名来判断一个文件是不是gif文件，这一部分由三个字符组成，文件版本号也是由3个字符组成，一般为87a，或者为89a\nGIF数据流部分 逻辑屏幕标识符(Logical Screen Descriptor) 这一部分由7个字节组成，定义了GIF图象的大小（高和宽之类）、颜色深度(Color Bits)、背景色(Blackground ColorIndex)以及有无全局颜色列表(Global Color Table)和颜色列表的索引数(ndex Count)\n具体描述见下表:\n目前只是需要这些，还有一些理论知识，还是得结合题目去研究\n考点 修补文件头 空间轴隐藏信息 时间轴隐藏信息 修复文件头 这种基本还好，结合上面的文件头部信息，只需要找到一张标准的gif文件,对照进行修补就可以了。\n空间轴隐藏信息 由于gif文件的特性，由一帧一帧文件组成，所以每一帧的图片，或者多张图片的结合，都可以隐藏信息\ngif的每一帧的宽高都得进行修改，或者进行分离，找出带有flag的那一帧\n解决方式 使用stesolvefj打开图片，Stegsolve Analyse-Frame Brower进行分帧，进行逐帧分析 可以使用conwert命令逐帧分开 convert persistant.gif transparent white result.gif 时间轴隐藏信息 每一帧的时间间隔也可以隐藏信息\n解决 通过工具的利用，来获得时间的间隔\nidentify命令清晰的打打印出每一顿的时间间隔 identify -format\"%Tn”100.gif根据时间间隔的规律解决题目\nmisc28 这次的图片是gif文件，可能这个文件有点不同，需要特殊修改，所以在网上看了一下\n这个图片的宽高信息与其他的图片不同，所以搜索找到修改就可以了\n利用模板，每次在打开新的图片文件的时候，010都会加载模板，这种模板可以大大的降低难度，因为模板可以显示出图片的信息，更为方便的修改，当然得是一个好的图片\n修改了以后，打开图片还是老样子，根本就不显示，flag，再在题目中搜索，发现只是改了一处地方，另一处的宽高并没有修改，可能是因为这是一张动图的原因，不太了解\ntip确实如此，gif的每一帧的宽高都得进行修改，或者进行分离，找出带有flag的那一帧\n所以这一得长个教训，以后改的话最好还是用搜索，因为在你不知道这个图片格式的情况下，即使你有模板，也不一顶能够完全的正确。\nmisc29 这一次的图片是10帧，就必须利用工具逐帧分析了，可以利用stegsolve工具\n在这之前，还需要先修改一下他的宽高，因为是10张图片，所以需要修改10次，gif的每一帧的宽高都得进行修改，或者进行分离，找出带有flag的那一帧，这里我就用的替换，将96 00全部替换为 84 03，这样的话就可以找到flag了。\nmisc30 这张图是bmp，并且被拉宽了，题目提示是直接修改宽度，可能是个开胃菜\n确实只是个开胃菜，套用了一下模板，找到了宽度修改以后就出来了\nmisc31 明说了，高度正确，宽度不对，基本得跑脚本了，当然也可以自己计算，网上也有\nimport struct import zlib f = open('./misc31.bmp','rb') c = f.read() width = c[18:22] height = c[22:26] # 爆破bmp宽度 for i in range(900,1100):#规定大概宽度区间 f1 = open('./bpout/'+str(i)+'.bmp','wb') #需要创建一个名为bpout的文件夹 # print(struct.pack('\u003ei',i)[::-1]) img = c[:18]+struct.pack('\u003ei',i)[::-1]+c[22:] f1.write(img) f1.close() 这个脚本本质也很简单，就是生成了100张图片，让你看看哪个是对的，找了找，发现是1082，出了\nmisc32 只高爆宽，我上脚本了，会的可以计算一下\nimport zlib import struct # 同时爆破宽度和高度 filename = \"misc32.png\" with open(filename, 'rb') as f: all_b = f.read() data = bytearray(all_b[12:29]) n = 4095 for w in range(n): width = bytearray(struct.pack('\u003ei', w)) for h in range(n): height = bytearray(struct.pack('\u003ei', h)) for x in range(4): data[x+4] = width[x] data[x+8] = height[x] crc32result = zlib.crc32(data) #替换成图片的crc if crc32result == 0xE14A4C0B: print(\"宽为：\", end = '') print(width, end = ' ') print(int.from_bytes(width, byteorder='big'), end=' ') print(hex(int.from_bytes(width, byteorder='big'))) print(\"高为：\", end = '') print(height, end = ' ') print(int.from_bytes(height, byteorder='big'), end=' ') print(hex(int.from_bytes(height, byteorder='big'))) # sys.exit() #如果加上可以立即结束程序，但是有利有弊吧 宽为：bytearray(b’\\x00\\x00\\x04\\x14’) 1044 高为：bytearray(b’\\x00\\x00\\x00\\x96’) 150\n宽为：bytearray(b’\\x00\\x00\\x04\\x14’) 1044 0x414 高为：bytearray(b’\\x00\\x00\\x00\\x96’) 150 0x96\nok,改一下，最好让他自己改为16进制，—chatgpt yyds\nmisc33 怎么说呢，逼着人用脚本。\n宽为：bytearray(b’\\x00\\x00\\x03\\xd2’) 978 0x3d2 高为：bytearray(b’\\x00\\x00\\x00\\x8e’) 142 0x8e\nmisc34 不得不说，出题人真的丧心病狂，狗急跳墙，crc也改了，这让我怎么爆破，看看上面的crc修复吧\n哦，大概知道了，高度知道，宽度大于900，那就直接用上面的生成200张不就好了\n对了，上面的是bmp脚本，这是需要修改一下二进制的宽高位置，我直接用chatgpt生成了，只能说yyds\nimport struct f = open('misc34.png','rb') c = f.read() chunk_width = c[16:20] chunk_height = c[20:24] # 爆破png宽度 for i in range(900,1300): #规定大概宽度区间 f1 = open('output/' + str(i) + '.png','wb') width = struct.pack('\u003ei', i) # 修改宽度信息 img = c[:16] + width + c[20:] f1.write(img) f1.close() misc35 这一道也是直接爆破，但是他有一个小小的很很可爱，因为他的高度不够，所以这里是埋了坑的，爆破前先吧高度给改了。 他这个宽高还是藏了的，所以搜一下03 84，常规操作。但是也有一点，他这个是jpg文件，新的脚本爆破一下吧\nimport zlib import struct filename = \"misc35.jpg\" with open(filename, 'rb') as f: all_b = f.read() #w = all_b[159:161] #h = all_b[157:159] for i in range(901,1200): name = str(i) + \".jpg\" f1 = open(name,\"wb\") im = all_b[:159]+struct.pack('\u003eh',i)+all_b[161:] f1.write(im) f1.close() 这个Python脚本以二进制读取模式打开JPEG图像文件“misc35.jpg”，它尝试通过暴力破解来查找正确的宽度值。它遍历901到1200之间的所有宽度值，并在每次循环中创建一个新的JPEG文件。对于每个i值，它将缓存的原始图像数据读入内存（名为’all_b’），并使用struct.pack将新的宽度值编码为2字节的无符号整数。然后，它使用切片操作构建一个新的JPEG图片数据，将新的宽度值插入到正确位置上，并将其写入到新的JPEG文件。原始文件不会受到修改。\n请注意，JPEG文件结构与PNG文件和BMP文件不同，因此您需要使用不同的字节偏移量来提取JPEG的宽度和高度。在这种情况下，使用了偏移量159-160和161来提取高度和宽度信息。由于JPEG是无损压缩的，因此无需导入zlib库来处理数据。\nmisc36 出题人坦白从宽，正确的宽度在920-950之间\n这么好吗，直接给他奸了，当然不要忘了一件事，那就是他的高度需要改一下，改了改了。不要忘了，得全局修改\n好了，可以开始爆破了，或者用crc，这次我要自己写，我说的\nimport zlib import struct image=open(\"misc36.gif\",\"rb\").read() for i in range(920,950): image1=open(str(i-900)+'.gif','wb') change=image[:image.index(b'\\x00\\x00\\x84\\x03\\x90\\x01')+2]+struct.pack('\u003eh',i)[::-1]+image[image.index(b'\\x00\\x00\\x84\\x03\\x90\\x01')+4:] image1.write(change) image1.close() misc37 一眼看过去一直在闪，第一反应是有很多帧，就是有很多帧，但是不知道为什么我第一次显示的只有1帧，直接用stegsolve打开就可以了，焯\n但是打开stegsolve只有一帧。但是打开\n010看了一下，肯定不止一帧，因为光是高度就有两个，搜索84 03甚至能搜到3个，基本可以判断是文件头给删了，开头的估计是对的，感觉是后面的出错了，所以对比修复一下\nAPNG 可以动的png文件，只有积累，而且这类图片的一个技巧就是可以在浏览器中打开\n而且这个文件中的数据块包含一个 ftcl块，在010中也可以看出来。\nmisc38 这是一个会动的apng图片，要使用浏览器才能看出来，whatfu*k！\n我怎么知道，而且用stegsolve还看不出来，要用特殊的分离工具上面有提到，无语死\n这篇文章是关于apng的介绍，可以提供一些思路\n用工具APNG Disassembler分离，9、17、36、40帧中藏有flag\nmisc39 flag就像水，忽快忽慢地流\n怎么说呢，我自己是看不出来的，就是gif三件套，文件头，空间轴，和时间轴，这个gif变化忽快忽慢，这就是时间间隔了。利用工具提取，kali里用命令identify -format \"%T \" misc39.gif \u003e misc39.txt提取帧数，\n37 37 36 36 36 37 37 37 37 37 36 37 36 36 37 37 36 36 37 37 36 37 37 37 36 36 37 37 37 37 36 37 36 36 36 37 37 36 37 37 37 37 37 37 37 36 37 37 37 37 37 37 37 36 37 37 36 37 37 36 37 36 37 36 37 37 36 36 37 36 36 37 37 37 36 36 36 36 37 37 36 36 36 37 36 37 37 36 36 37 36 37 37 36 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 37 36 37 37 36 37 36 37 37 37 36 36 37 37 36 37 37 36 36 36 37 36 36 37 37 36 37 37 37 37 37 36 36 36 37 36 37 37 36 36 37 36 37 36 37 37 36 36 37 36 36 37 37 36 37 37 36 36 37 37 37 36 36 36 37 37 36 36 37 36 36 36 37 37 37 36 36 37 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 37 36 36 36 36 37 36 37 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 36 37 36 37 37 36 36 36 37 37 37 37 36 36 36 36 37 36 37 37 36 36 36 36 36 37 37 36 37 36 36 36 37 37 36 37 36 37 36 37 37 37 36 36 37 37 37 37 37 37 36 37\n时间间隔就是这些，然后呢，哈哈哈哈哈哈，当然是一个0一个1，你问我那个是0，那个是1，肯定是小的是0大的是1，当然也比较好换，统一减去36就可以了，你问我太多了怎么办，我告诉你写个脚本就可以了，你问我脚本呢，我告诉你我直接用的chatgpt，\n然后放入010里面看看是何方神圣，不对这个二进制直接转化为ascil码，然后转化为字符就可以了\ns=\"1 1 0 0 0 1 1 1 1 1 0 1 0 0 1 1 0 0 1 1 0 1 1 1 0 0 1 1 1 1 0 1 0 0 0 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 0 1 1 0 1 0 1 0 1 1 0 0 1 0 0 1 1 1 0 0 0 0 1 1 0 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 1 0 0 1 1 0 0 1 1 1 0 0 1 0 1 1 1 0 0 1 0 1 1 0 1 0 1 1 1 0 0 1 1 0 1 1 0 0 0 1 0 0 1 1 0 1 1 1 1 1 0 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 0 1 1 0 1 1 0 0 1 1 1 0 0 0 1 1 0 0 1 0 0 0 1 1 1 0 0 1 0 1 1 0 1 1 0 0 1 1 0 0 1 1 1 1 0 0 0 0 1 0 1 1 1 0 0 1 1 1 0 0 1 0 1 1 1 0 0 0 1 0 1 1 0 0 0 1 1 1 1 0 0 0 0 1 0 1 1 0 0 0 0 0 1 1 0 1 0 0 0 1 1 0 1 0 1 0 1 1 1 0 0 1 1 1 1 1 1 0 1\" flag=\"\" print(s) for i in range(82): s=s.replace(' ','') for i in range(41): flag +=chr(int(s[7*i:7*(i+1)],2)) #二进制，每隔7个二进制转化为ascil码，然后再转化为字符 print(flag) misc40 flag就像歌，有长有短仿佛岁月悠悠\n我就挺好奇的，这些apng图，我怎么才能看出来，直接打开工具给分离一下呗，毕竟都说flag像歌了，\n文件分离完成之后，在图片中找不到直接的flag了，但是如何才能找到呢，就要从文本文档入手了，可是这些文本又有什么用呢，打开看了一下，有序号，先用python给提取出\nflag=\"\" for i in range(1,69): f=open('apngframe'+str(i).zfill(2)+'.txt') s=f.read() flag += chr(int(s.split(\"/\")[0][6:])) print(str(flag)) 直接运行就出了。但是有一些多余的\nmisc42 flag有多长，不太懂了，也不是个动图，打开010吧，看不出来。\n还是得懂得运用工具，我开了一下tweakpng。果然有问题，这个图片有着高达几十的idat块，先尝试删除试试再说。\n好吧，删了一堆还是没有变化，再看2cm，41位，肯定都别有深意，\n41位，这是flag的长度值，而且这个的idat块差不多有50个，这时候就要用到刚才说的长度了\n2cm，这个想表达的不是2，而是cm，对应的应该就是这个Length,现在就知道了，就是这一堆数，复制下来，转一下\na = [229,152,191,229,152,191,49,99,116,102,115,104,111,119,123,48,55,56,99,98,100,48,102,57,99,56,100,51,102,50,49,53,56,101,55,48,53,50,57,102,56,57,49,51,99,54,53,125] flag=\"\" for i in a: flag+=chr(i) print(flag) misc43 错误中通往这蕴涵正确的道路\n这句话很明显了。图片是个错误文件，但是电脑能打开呀，很熟悉，至少我知道的就有一种，那就是crc的错误，拿专业(bushi)工具，或者kali，就会报错，错误的crc for idat\n解决 第一个是试试修改图片的尺寸，不对，有蹊跷，妈的，不但有错误，还不止一个，首先有很多idat，其次就是基本每个idat都有错误\n，而且这次的长度值都一样，可能是crc的编码隐藏信息了。由于这里不好看出来具体是那个crc的错误，所以我先用另一个工具\npngdebugger PNG Debugger 可以进行读取 PNG 图片的数据，检测各数据块中的 CRC 是否正确，在 Windows 下使用。\n使用命令\nPNGDebugger.exe 文件路径 ---直接打开 PNGDebugger.exe misc44.png \u003e 1.txt --导出来 注意一下，上面的才是crc的值，下面的虽然在tweakpng中有，但是似乎并不是想要的，而上面的才是我们需要的，可能上面的是正确的，不知\n我又看了一下，上面的可以在010里面搜到，但是下面的搜不到，所以说明下面的是修正后的，原来的crc，而上面的是被人为制造的，所以也恰恰说明了为什么上面的当中蕴含信息\nE59387E593A62E63746673686F777B36656232353839666666663565333930666536623837353034646263303839327D\nmisc44 错误中还有坑，那就是好消息，和上一道题一样呗，可能这道题，需要将图片修复，先用pngdebugger跑一下，还是有对有错，可能是因为不是全错的，这样的话就有很大的问题，因为正确的crc是自动生成的，不可能隐藏信息，所以只能把出错的找出来\n发现和上一题差的其实挺多的，因为这里有100多个错误的idat，就算全部都给他提取出来的话也太多了。所以考虑到了二进制，因为OK和FAILED可以作为0和1，至于哪个是0，那个是1，试一试呗，反正也就两种。至于怎么提取出来，还是得利用chatgpt\nwith open(\"1.txt\") as f: lines = f.readlines() output = \"\" for i in range(5, len(lines), 6): # starting at line 6, increment by 6 if \"OK\" in lines[i]: output += \"1\" elif \"FAILED\" in lines[i]: output += \"0\" print(hex(int(output,2))[2:]) 此代码指定了一个以5为起点，以每6个为步长的范围，该范围包括名为1.txt的文本文件中的第六行和其倍数的行。 对于每个行索引（即i），代码检查该行是否包含OK或FAILED。如果找到了相应的标记，则代码将\"0\"或\"1\"添加到输出字符串。\n但是上面的代码存在错误，就是将二进制转化为了16进制，这样的得到的并不是正确答案，再转字符串就好了\nwith open(\"1.txt\") as f: lines = f.readlines() binary_string = \"\" for i in range(5, len(lines), 6): # starting at line 6, increment by 6 if \"OK\" in lines[i]: binary_string += \"1\" elif \"FAILED\" in lines[i]: binary_string += \"0\" text_string = \"\" for j in range(0, len(binary_string), 8): byte = binary_string[j:j+8] decimal = int(byte, 2) character = chr(decimal) text_string += character print(text_string) 二进制转字符串，16进制转字符串之类的python脚本 misc45 说是换一种思维方式，估计是换题型了。图片混不拉基的，看看是不是idat的问题，这个没问题，但是确实不太一样，打开tweakpng确实藏着一些东西，但是不太明白是什么。搜一搜了得\n怎么说呢，正确的做法是将这个文件转化为bmp文件再接着做，题目中也有提示，就是尝试思维格式，转换网站网站可以在此，然后在拉进binwalk分析，有个flag.png,拿出来就ok了\n其实这一道题，拿到tweak打开时，会显示bmp的一些信息， 这个8bit的深度转换，是bmp的一个明显的特征。\nmisc46 打开是个gif动图，先逐帧看一下，看了一下没有动，问题应该不在那里，先看看题目要求\n直接看了看wp，实在没有什么思路，也算是对gif提题型的一种补充。用identify提取他的详细信息，identify misc46.gif \u003e1.txt然后接下来就把他里面的坐标偏移量提取出来，利用画图工具输出gnuplot\nmisc47 那你知道笔仙吗，不知道，然后这又是一张apng，直接分解看看有没有信息，563张，和上一道题的帧数一样，可能差不多，直接打开来看看。都是100，看来这个delay值的作用不大了，去别的地方看看吧，这篇文章是关于apng的介绍，可以提供一些思路。简单来说就是每一个IDAT块前面都会有一个fcTL块，它其中就包含水平垂直偏移量，然后就写个代码，将里面的所有偏移量提取出来。我的大致思路，是将文件的16进制读取到文本中，然后把相应位置的数据提出来，因为每个\nfrom PIL import Image import re print(1) im =Image.new('RGB',(400,80),255) f=open('output.txt','r')#将图片的16制文件保存到这里，全选ctrl+shift+a就可以复制了 c=f.read() f.close() print(1) It =c.split(\"6663544C\")#这段代码将字符串变量c按照字符串\"6663544C(fcTL)\"分割成一个列表变量lt。该字符串\"6663544C\"是用作分割符的特定字符串，根据实际数据格式可以进行更改。分割后，列表lt中的每个元素都是原始字符串中包含两个16进制坐标数据的子字符串。在后续代码中，程序通过解析并提取这些坐标数据，来处理或操作原始数据。 print(len(It),len(c)) for i in range(493): x=int(It[i][28:32],16)#找到x的偏移，取6663544C后的第28到31个字节，16是16进制，用于int的转化为整形 y=int(It[i][36:40],16) im.putpixel((x,y)) misc48 附件的第（Di）七（Qi）题（Ti）中有提示。本题略脑洞，可跳过\n首先这是一个jpg，看里面可能有exif信息，打开exitool看一下，没有什么。然后就注意题目，其实jpg中有个模块是DQT，选中查看，\n**ctfshow{32}**在题目中可以看到这个，那就知道了大体框架和字母的数字，然后再去看DQT模块的玄机。可以看到有很多FF，就要从就能从这个入手了\nmisc49 它们一来就是十六种。本题略脑洞，可跳过\n这是一个jpg图片，打开exif没有什么有用的信息，麻了，看了wp之后，再做一做。\n首先里面有很多字符串，看看他们的共同之处，他们共同点就是前面都有FF Ed的16进制\n​ 0c618671a13f5da394fb2a2238e44\nctfshow{0c618671a153f5da3948fdb2a2238e44}\nmisc50 有时候视线需要放低一点\n需要用stegsolve不停的切换图片通道就可以了。\nmisc51 你会数数吗\nmisc52 麻了，实在搞不懂\nLSB misc53 开始愉快的LSB\n确实愉快，直接开干吧，基础的LSB隐写，打开stegsolve，打开data extract，勾选red green blue的0位，然后勾选LSB first，就可以看到了\nmisc54 ",
  "wordCount" : "10270",
  "inLanguage": "en",
  "datePublished": "2023-05-07T20:05:06+08:00",
  "dateModified": "2023-05-07T20:05:06+08:00",
  "author":[{
    "@type": "Person",
    "name": "Modest"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://modesty258.github.io/posts/misc/wp/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Modest's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://modesty258.github.io/img/Q.gif"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://modesty258.github.io/" accesskey="h" title="Modest&#39;s Blog (Alt + H)">
            <img src="https://modesty258.github.io/img/Q.gif" alt="logo" aria-label="logo"
                 height="35">Modest&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://modesty258.github.io/search" title="🔍 搜索 (Alt &#43; /)" accesskey=/>
                <span>🔍 搜索</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/" title="🏠 主页">
                <span>🏠 主页</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/posts" title="📚 文章">
                <span>📚 文章</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/tags" title="🧩 标签">
                <span>🧩 标签</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/archives/" title="⏱️ 时间轴">
                <span>⏱️ 时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/about" title="🙋🏻‍♂️ 关于">
                <span>🙋🏻‍♂️ 关于</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/links" title="🤝 友链">
                <span>🤝 友链</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="https://modesty258.github.io/">🏠 主页</a>&nbsp;»&nbsp;<a href="https://modesty258.github.io/posts/">📚文章</a>&nbsp;»&nbsp;<a href="https://modesty258.github.io/posts/misc/">📚misc</a></div>
            <h1 class="post-title">
                Wp
            </h1>
            <div class="post-description">
                ctfshow的图片类题目
            </div>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2023-05-07
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>10270字
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>21分钟
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>Modest
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    <span id="post_meta_style_8">
                        <span class="fa fa-commenting-o"></span>
                        <span>
                            <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js"></script>
                            <script>
                                let url = document.documentURI
                                
                                let dnsUrl = "https://modesty258.github.io/"
                                let urlSplit = url.split(dnsUrl)
                                let finalUrl = urlSplit[1]
                                if (finalUrl[0] !== '/') {
                                    finalUrl = '/'+finalUrl
                                }
                                twikoo.getCommentsCount({
                                    envId:  null , 
                                region:  null , 
                                urls: [ 
                                    
                                    finalUrl,
                                ],
                                    includeReply: false 
                                }).then(function (res) {
                                    let count = res[0].count
                                    const obj = document.getElementById("comment_count");
                                    obj.innerText = count
                                    
                                    
                                    
                                }).catch(function (err) {
                                    
                                    console.error(err);
                                });
                            </script>
                            <span id="comment_count"></span>
                        </span>
                    </span>
                </span>

</div>
        </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">文章目录</span>
            </summary>

            <div class="inner"><ul><ul>
                    <li>
                        <a href="#misc1" aria-label="misc1">misc1</a></li>
                    <li>
                        <a href="#misc2" aria-label="misc2">misc2</a></li>
                    <li>
                        <a href="#misc3" aria-label="misc3">misc3</a></li>
                    <li>
                        <a href="#misc4" aria-label="misc4">misc4</a></li>
                    <li>
                        <a href="#misc5" aria-label="misc5">misc5</a></li>
                    <li>
                        <a href="#misc6" aria-label="misc6">misc6</a></li>
                    <li>
                        <a href="#misc7" aria-label="misc7">misc7</a></li>
                    <li>
                        <a href="#misc8" aria-label="misc8">misc8</a></li>
                    <li>
                        <a href="#misc9" aria-label="misc9">misc9</a></li>
                    <li>
                        <a href="#misc10" aria-label="misc10">misc10</a></li>
                    <li>
                        <a href="#misc11" aria-label="misc11">misc11</a><ul>
                            
                    <li>
                        <a href="#tweakpng-httpsctfshowwriteups841466-irfanview%e5%9b%be%e7%89%87%e9%9a%90%e5%86%99%e6%9c%af" aria-label="tweakpng Irfanview图片隐写术"><a href="https://ctf.show/writeups/841466">tweakpng </a> Irfanview图片隐写术</a><ul>
                            
                    <li>
                        <a href="#%e5%b8%b8%e8%a7%81%e9%94%99%e8%af%af" aria-label="常见错误">常见错误</a></li>
                    <li>
                        <a href="#1%e5%9b%be%e7%89%87crc%e8%a2%ab%e4%bf%ae%e6%94%b9" aria-label="1）图片CRC被修改">1）图片CRC被修改</a></li>
                    <li>
                        <a href="#2%e5%9b%be%e7%89%87%e5%b0%ba%e5%af%b8%e8%a2%ab%e4%bf%ae%e6%94%b9" aria-label="2）图片尺寸被修改">2）图片尺寸被修改</a><ul>
                            
                    <li>
                        <a href="#%e8%a7%a3%e5%86%b3" aria-label="解决">解决</a></li></ul>
                    </li></ul>
                    </li></ul>
                    </li></ul>
                        
                    <li>
                        <a href="#tweakpng--idat" aria-label="tweakpng  idat">tweakpng  idat</a><ul>
                            
                    <li>
                        <a href="#misc12" aria-label="misc12">misc12</a></li>
                    <li>
                        <a href="#misc13" aria-label="misc13">misc13</a></li>
                    <li>
                        <a href="#misc14" aria-label="misc14">misc14</a></li></ul>
                    </li>
                    <li>
                        <a href="#dd--%e6%96%87%e4%bb%b6%e5%88%86%e7%a6%bb" aria-label="dd  文件分离">dd  文件分离</a><ul>
                            <ul>
                            <ul>
                            
                    <li>
                        <a href="#%e8%a7%a3%e6%b3%95%e4%ba%8c" aria-label="解法二">解法二</a></li></ul>
                        </ul>
                        
                    <li>
                        <a href="#misc15" aria-label="misc15">misc15</a></li>
                    <li>
                        <a href="#misc16" aria-label="misc16">misc16</a></li>
                    <li>
                        <a href="#binwalk-tip" aria-label="binwalk tip">binwalk tip</a></li></ul>
                    </li>
                    <li>
                        <a href="#zsteg---%e6%a3%80%e6%b5%8b%e9%9a%90%e5%86%99" aria-label="zsteg   检测隐写">zsteg   检测隐写</a><ul>
                            
                    <li>
                        <a href="#misc17" aria-label="misc17">misc17</a></li>
                    <li>
                        <a href="#misc18" aria-label="misc18">misc18</a></li>
                    <li>
                        <a href="#misc19" aria-label="misc19">misc19</a></li></ul>
                    </li>
                    <li>
                        <a href="#exiftool%e7%ae%80%e4%bb%8b-%e6%9f%a5%e7%9c%8b%e5%9b%be%e7%89%87%e7%ae%80%e4%bb%8b" aria-label="exiftool简介 查看图片简介">exiftool简介 查看图片简介</a><ul>
                            
                    <li>
                        <a href="#misc20" aria-label="misc20">misc20</a></li>
                    <li>
                        <a href="#misc21" aria-label="misc21">misc21</a></li>
                    <li>
                        <a href="#misc22" aria-label="misc22">misc22</a></li>
                    <li>
                        <a href="#misc23" aria-label="misc23">misc23</a><ul>
                            
                    <li>
                        <a href="#%e6%97%b6%e9%97%b4%e6%88%b3" aria-label="时间戳">时间戳</a></li></ul>
                    </li>
                    <li>
                        <a href="#misc41" aria-label="misc41">misc41</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%96%87%e4%bb%b6%e7%bb%93%e6%9e%84" aria-label="文件结构">文件结构</a><ul>
                            
                    <li>
                        <a href="#misc24" aria-label="misc24">misc24</a></li>
                    <li>
                        <a href="#misc25" aria-label="misc25">misc25</a></li>
                    <li>
                        <a href="#misc26" aria-label="misc26">misc26</a></li>
                    <li>
                        <a href="#misc27" aria-label="misc27">misc27</a></li></ul>
                    </li>
                    <li>
                        <a href="#gif" aria-label="gif">gif</a><ul>
                            
                    <li>
                        <a href="#%e6%96%87%e4%bb%b6%e5%a4%b4%e9%83%a8%e5%88%86header" aria-label="文件头部分(Header)">文件头部分(Header)</a><ul>
                            <ul>
                            
                    <li>
                        <a href="#gif%e7%bd%b2%e5%90%8d%e5%92%8c%e7%89%88%e6%9c%ac%e5%8f%b7" aria-label="GIF署名和版本号">GIF署名和版本号</a></li>
                    <li>
                        <a href="#gif%e6%95%b0%e6%8d%ae%e6%b5%81%e9%83%a8%e5%88%86" aria-label="GIF数据流部分">GIF数据流部分</a><ul>
                            
                    <li>
                        <a href="#%e9%80%bb%e8%be%91%e5%b1%8f%e5%b9%95%e6%a0%87%e8%af%86%e7%ac%a6logical-screen-descriptor" aria-label="逻辑屏幕标识符(Logical Screen Descriptor)">逻辑屏幕标识符(Logical Screen Descriptor)</a></li></ul>
                    </li></ul>
                        
                    <li>
                        <a href="#%e8%80%83%e7%82%b9" aria-label="考点">考点</a><ul>
                            
                    <li>
                        <a href="#%e4%bf%ae%e5%a4%8d%e6%96%87%e4%bb%b6%e5%a4%b4" aria-label="修复文件头">修复文件头</a></li>
                    <li>
                        <a href="#%e7%a9%ba%e9%97%b4%e8%bd%b4%e9%9a%90%e8%97%8f%e4%bf%a1%e6%81%af" aria-label="空间轴隐藏信息">空间轴隐藏信息</a><ul>
                            
                    <li>
                        <a href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e5%bc%8f" aria-label="解决方式">解决方式</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e6%97%b6%e9%97%b4%e8%bd%b4%e9%9a%90%e8%97%8f%e4%bf%a1%e6%81%af" aria-label="时间轴隐藏信息">时间轴隐藏信息</a><ul>
                            
                    <li>
                        <a href="#%e8%a7%a3%e5%86%b3-1" aria-label="解决">解决</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#misc28" aria-label="misc28">misc28</a></li>
                    <li>
                        <a href="#misc29" aria-label="misc29">misc29</a></li>
                    <li>
                        <a href="#misc30" aria-label="misc30">misc30</a></li>
                    <li>
                        <a href="#misc31" aria-label="misc31">misc31</a></li>
                    <li>
                        <a href="#misc32" aria-label="misc32">misc32</a></li>
                    <li>
                        <a href="#misc33" aria-label="misc33">misc33</a></li>
                    <li>
                        <a href="#misc34" aria-label="misc34">misc34</a></li>
                    <li>
                        <a href="#misc35" aria-label="misc35">misc35</a></li>
                    <li>
                        <a href="#misc36" aria-label="misc36">misc36</a></li>
                    <li>
                        <a href="#misc37" aria-label="misc37">misc37</a></li></ul>
                    </li>
                    <li>
                        <a href="#apng" aria-label="APNG">APNG</a><ul>
                            
                    <li>
                        <a href="#misc38" aria-label="misc38">misc38</a></li>
                    <li>
                        <a href="#misc39" aria-label="misc39">misc39</a></li>
                    <li>
                        <a href="#misc40" aria-label="misc40">misc40</a></li>
                    <li>
                        <a href="#misc42" aria-label="misc42">misc42</a></li>
                    <li>
                        <a href="#misc43" aria-label="misc43">misc43</a><ul>
                            <ul>
                            <ul>
                            
                    <li>
                        <a href="#%e8%a7%a3%e5%86%b3-2" aria-label="解决"><strong>解决</strong></a></li></ul>
                        </ul>
                        </ul>
                    </li>
                    <li>
                        <a href="#pngdebugger" aria-label="pngdebugger">pngdebugger</a></li>
                    <li>
                        <a href="#misc44" aria-label="misc44">misc44</a></li>
                    <li>
                        <a href="#%e4%ba%8c%e8%bf%9b%e5%88%b6%e8%bd%ac%e5%ad%97%e7%ac%a6%e4%b8%b216%e8%bf%9b%e5%88%b6%e8%bd%ac%e5%ad%97%e7%ac%a6%e4%b8%b2%e4%b9%8b%e7%b1%bb%e7%9a%84python%e8%84%9a%e6%9c%ac" aria-label="二进制转字符串，16进制转字符串之类的python脚本">二进制转字符串，16进制转字符串之类的python脚本</a></li>
                    <li>
                        <a href="#misc45" aria-label="misc45">misc45</a></li>
                    <li>
                        <a href="#misc46" aria-label="misc46">misc46</a></li>
                    <li>
                        <a href="#misc47" aria-label="misc47">misc47</a></li>
                    <li>
                        <a href="#misc48" aria-label="misc48">misc48</a></li>
                    <li>
                        <a href="#misc49" aria-label="misc49">misc49</a></li>
                    <li>
                        <a href="#misc50" aria-label="misc50">misc50</a></li>
                    <li>
                        <a href="#misc51" aria-label="misc51">misc51</a></li>
                    <li>
                        <a href="#misc52" aria-label="misc52">misc52</a></li></ul>
                    </li>
                    <li>
                        <a href="#lsb" aria-label="LSB">LSB</a><ul>
                            
                    <li>
                        <a href="#misc53" aria-label="misc53">misc53</a></li>
                    <li>
                        <a href="#misc54" aria-label="misc54">misc54</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

        <div class="post-content"><p>umi-ocr图片提取工具</p>
<h2 id="misc1">misc1<a hidden class="anchor" aria-hidden="true" href="#misc1">#</a></h2>
<p>解压就行</p>
<h2 id="misc2">misc2<a hidden class="anchor" aria-hidden="true" href="#misc2">#</a></h2>
<p>解压一个文本文件，然后打开都是乱码，打开010看一下</p>
<p>开头就是89 50可以知道了这是一个png文件，然后改为了txt后缀，把后缀改回来就可以了</p>
<h2 id="misc3">misc3<a hidden class="anchor" aria-hidden="true" href="#misc3">#</a></h2>
<p>解压完发现是一个bpg文件，没有什么技巧，直接查看就行了</p>
<h2 id="misc4">misc4<a hidden class="anchor" aria-hidden="true" href="#misc4">#</a></h2>
<p>这道题解压后有6个txt文件，和第二题一样，这道题也是文件后缀，只不过是6个，一个一个改了在进行拼接就行了</p>
<h2 id="misc5">misc5<a hidden class="anchor" aria-hidden="true" href="#misc5">#</a></h2>
<p>打开后显示flag不在这里，仔细找了下，在010中可以找到</p>
<h2 id="misc6">misc6<a hidden class="anchor" aria-hidden="true" href="#misc6">#</a></h2>
<p>和上一道题目一样，只不过不在结尾了，在中间，需要仔细找找</p>
<h2 id="misc7">misc7<a hidden class="anchor" aria-hidden="true" href="#misc7">#</a></h2>
<p>和上一道一样，需要搜一下</p>
<h2 id="misc8">misc8<a hidden class="anchor" aria-hidden="true" href="#misc8">#</a></h2>
<p>题目说在图片文件中，但是实在肉眼找不到，尝试用txt后缀，但是看不到，这时候使用到了binwalk等分离工具</p>
<p>binwalk看到文件其实还含有一张png文件，利用foremost分离</p>
<p>文件就直接出来了，flag就在文件里面</p>
<h2 id="misc9">misc9<a hidden class="anchor" aria-hidden="true" href="#misc9">#</a></h2>
<p>看不懂，我出的时候感觉还是炒冷饭</p>
<h2 id="misc10">misc10<a hidden class="anchor" aria-hidden="true" href="#misc10">#</a></h2>
<p>找了找没找到，直接分离出来了，感觉还是炒冷饭</p>
<h2 id="misc11">misc11<a hidden class="anchor" aria-hidden="true" href="#misc11">#</a></h2>
<p>flag在另一张图，很明显的提示，用binwalk看了一眼，只有一个图片文件，还有一个bzip2文件，不知道该怎么处理</p>
<h3 id="tweakpng-httpsctfshowwriteups841466-irfanview图片隐写术"><a href="https://ctf.show/writeups/841466">tweakpng </a> Irfanview图片隐写术<a hidden class="anchor" aria-hidden="true" href="#tweakpng-httpsctfshowwriteups841466-irfanview图片隐写术">#</a></h3>
<p>在杂项中，经常会遇到图片被修改，可能是尺寸，也有可能是其他的，但是默认的图片编辑器不会报错，但是专业的文件编辑器会报错，比如上面的两个，</p>
<h4 id="常见错误">常见错误<a hidden class="anchor" aria-hidden="true" href="#常见错误">#</a></h4>
<p><strong>crc错误</strong></p>
<p>这里有两种可能</p>
<h4 id="1图片crc被修改">1）图片CRC被修改<a hidden class="anchor" aria-hidden="true" href="#1图片crc被修改">#</a></h4>
<p>可以尝试用十六进制编辑器打开图片，修改CRC。</p>
<h4 id="2图片尺寸被修改">2）图片尺寸被修改<a hidden class="anchor" aria-hidden="true" href="#2图片尺寸被修改">#</a></h4>
<p>这时候就要用十六进制编辑器修改图片尺寸了。</p>
<h5 id="解决">解决<a hidden class="anchor" aria-hidden="true" href="#解决">#</a></h5>
<p>对于还原尺寸，可以利用蒙一下，也可以用个脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> binascii
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>crcbp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;xxx.png&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>)<span style="color:#f92672">.</span>read()    <span style="color:#75715e">#打开图片</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2000</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2000</span>):
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> crcbp[<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> \
</span></span><span style="display:flex;"><span>            struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>, i)<span style="color:#f92672">+</span>struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>, j)<span style="color:#f92672">+</span>crcbp[<span style="color:#ae81ff">24</span>:<span style="color:#ae81ff">29</span>]
</span></span><span style="display:flex;"><span>        crc32 <span style="color:#f92672">=</span> binascii<span style="color:#f92672">.</span>crc32(data) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffffffff</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(crc32 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x38162a34</span>):    <span style="color:#75715e">#图片当前CRC</span>
</span></span><span style="display:flex;"><span>            print(i, j)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;hex:&#39;</span>, hex(i), hex(j))
</span></span></code></pre></div><p>使用时修改脚本中的打开图片名称和图片当前CRC</p>
<p>然后在图片所在目录运行Python脚本</p>
<p>再用010改一下就可以了</p>
<h1 id="tweakpng--idat">tweakpng  idat<a hidden class="anchor" aria-hidden="true" href="#tweakpng--idat">#</a></h1>
<p><strong>当然这一题用的不是上面的，需要用到这个文件</strong></p>
<p>使用tweakpng打开文件，发现有两个idat文件头，这就说明有问题，</p>
<p><strong>默认的图片是以第一个idat块来显示</strong>，所以将下面的移上去，或者把第一个删除就可以了</p>
<p>虽然不知道什么原理，将上面的删除了就会显示下面的idat数据头，可能是因为每个idat都对应一个图片，所以只能换一下，或者将下面的移到上面</p>
<h2 id="misc12">misc12<a hidden class="anchor" aria-hidden="true" href="#misc12">#</a></h2>
<p>和上一题一样，有很多idat块，只不过不知道哪一个才是，但是肯定知道最上面的不是，所以一个一个的删除，肯定有一个是</p>
<p>在删除的过程中，发现中间的几个都是无效的，删到第八个的时候就出来了正确的</p>
<h2 id="misc13">misc13<a hidden class="anchor" aria-hidden="true" href="#misc13">#</a></h2>
<blockquote>
<p><strong>flag位置在图片末尾。</strong></p>
</blockquote>
<p>打开010，能看出来图片中含有flag，但是被编码了</p>
<p>分离了一下，里面估计没有txt文件了，还是尝试解码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ct¹f…s†hªoKw°{!aeS6¥eT446xc%4Ý8ïf«73•9b‚7ºeEb|2Td~1:däeñ6úeõ412fT8ñ329éal}
</span></span></code></pre></div><p>不是base，仔细一看，根本就没有编码，只是每两个之间用一个特殊字符隔开了，尝试用python来跑个脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ct¹f…s†hªoKw°{!aeS6¥eT446xc%4Ý8ïf«73•9b‚7ºeEb|2Td~1:däeñ6úeõ412fT8ñ329éal}&#34;</span>
</span></span><span style="display:flex;"><span>flag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(a),<span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>	hexStr<span style="color:#f92672">=</span>a[i]
</span></span><span style="display:flex;"><span>	flag<span style="color:#f92672">+=</span>hexStr
</span></span><span style="display:flex;"><span>print(flag)
</span></span></code></pre></div><p><code> ctfshow{ae6e46c48f739b7eb2d1de6e412f839a}</code></p>
<p>ctfshow{ae6e3ea48f518b7e42d7de6f412f839a}</p>
<h2 id="misc14">misc14<a hidden class="anchor" aria-hidden="true" href="#misc14">#</a></h2>
<h1 id="dd--文件分离">dd  文件分离<a hidden class="anchor" aria-hidden="true" href="#dd--文件分离">#</a></h1>
<p>binwalk分析一下，发现有两个文件，直接分离</p>
<p>临时学习了个<strong>dd</strong>指令，用来分离文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>dd if=misc14.jpg of=1.png skip=2103 bs=1
</span></span></code></pre></div><p>if代表输入文件，of代表输出文件，skip代表跳过到多少个块后开始（binwalk可以看到），bs是代表字节为单位的块的大小，参数还有很多，目前先记住这几个就能分出图片了。</p>
<p>这里由于binwalk查看到在2103个块开始还有一个JPEG文件，那就直接shkip到2103开始分离。</p>
<p>成功得到flag。</p>
<h4 id="解法二">解法二<a hidden class="anchor" aria-hidden="true" href="#解法二">#</a></h4>
<p>从binwalk可以看到里面有两个jpg文件，可以直接用010将另一个文件直接从里面提取出来，直接找到文件头FF D8，第三个就是我们需要的，直接复制出来生成一个新的文件就可以了</p>
<p><img loading="lazy" src="/img/6.png" alt="img"  />
</p>
<h2 id="misc15">misc15<a hidden class="anchor" aria-hidden="true" href="#misc15">#</a></h2>
<p>是一个bmp文件，拿binwalk分析了以下没看见啥有用的。</p>
<p>直接搜，拿010</p>
<h2 id="misc16">misc16<a hidden class="anchor" aria-hidden="true" href="#misc16">#</a></h2>
<p>binwalk扫一下，发下确实有点东西，但是不懂，不像之前有图片文本来得那么直接</p>
<p>诶，怎么说呢，有时候可能不一定没有txt就没有文本，可以用binwalk直接分离出来一个dd4，没错，就是他</p>
<h2 id="binwalk-tip">binwalk tip<a hidden class="anchor" aria-hidden="true" href="#binwalk-tip">#</a></h2>
<p>怎么说呢，以后遇见题目，即使没有你认识的文件，也要尝试分离一下，分离不出来就用foremost或者dd，或者其他的一些，<strong>总而言之只要里面不是一个文件，就分离出来再继续做</strong></p>
<h1 id="zsteg---检测隐写">zsteg   检测隐写<a hidden class="anchor" aria-hidden="true" href="#zsteg---检测隐写">#</a></h1>
<p>zsteg可以检测PNG和BMP图片里的隐写数据。</p>
<p>目前，zsteg支持检测：</p>
<ul>
<li>PNG 和 BMP 格式的 LSB 隐写术</li>
<li>zlib 压缩数据</li>
<li><a href="http://openstego.sourceforge.net/">打开Stego</a></li>
<li>Camouflage 1.2.1</li>
<li>LSB</li>
</ul>
<p><strong>还是转到分离工具去看用法吧</strong></p>
<p>这里先浅浅的使用一下</p>
<h2 id="misc17">misc17<a hidden class="anchor" aria-hidden="true" href="#misc17">#</a></h2>
<p>直接分析，里面还有一个bzip2</p>
<p>因为直接用分离工具提取会将文件损坏，所以只好用zsteg工具</p>
<p>直接用zsteg看一下隐藏文件，看到了16进制，但是并没有flag，</p>
<p>直接用zsteg将隐藏文件提取到一个1.txt当中，打开再看，发现是乱码，再用binwalk分离一下就有了</p>
<p><strong>看了一下</strong>wp，发现当时用zsteg检测出来的<strong>extradata:0</strong> ，是在这个里面存在隐藏数据，所以应该将这个文件给提取出来，所以就有了对应的命令<code>   zsteg -E “extradata:0” misc17.png &gt; 1.txt</code></p>
<h2 id="misc18">misc18<a hidden class="anchor" aria-hidden="true" href="#misc18">#</a></h2>
<p>看题目要求就知道了，在图片的属性里面，就是不知道010能不能看出来试试</p>
<p>嗯，010是有的，但是有一点，他得拼接，我认为还是属性方便</p>
<blockquote>
<p>ctfshow{325d60c208f728ac17e5f02d4cf5a839}</p>
</blockquote>
<h2 id="misc19">misc19<a hidden class="anchor" aria-hidden="true" href="#misc19">#</a></h2>
<p>ctfshow{dfdcf08038cd446a5eb50782f8d3605d}</p>
<p>怎么说呢，属性不一定能找到，但是010一定可以找到</p>
<h1 id="exiftool简介-查看图片简介">exiftool简介 查看图片简介<a hidden class="anchor" aria-hidden="true" href="#exiftool简介-查看图片简介">#</a></h1>
<p>这个软件能扫出来图片的作者，等属性信息，主机，评论什么的也可以直接显示出来，以后可以直接看一眼</p>
<p>命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>exiftool flie_name
</span></span></code></pre></div><h2 id="misc20">misc20<a hidden class="anchor" aria-hidden="true" href="#misc20">#</a></h2>
<p>直接用exiftool找出来了图片的所有信息，基本有了</p>
<blockquote>
<p>这图片也太难看了。来自：西替爱抚秀大括号西九七九六四必一诶易西爱抚零六易一弟七九西二一弟弟诶弟五九三易四二大括号</p>
</blockquote>
<p>很显然了，这就是flag</p>
<p>ctfshow{c97964b1aecf06e1d79c21ddad593e42}</p>
<h2 id="misc21">misc21<a hidden class="anchor" aria-hidden="true" href="#misc21">#</a></h2>
<p>题目说是看序号，打开010看了一看，大概有思路了，首先题目给出了，在010中也看到了数字，应该是某种加密，再不济也是一个ascil</p>
<p>然后用exif工具扫了一下，看到了编码方式<strong>Baseline DCT, Huffman coding</strong>就是霍夫曼编码，先复制出来，再解一下就ok了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>X Resolution: 3902939465     0xe8a22149
</span></span><span style="display:flex;"><span>Y Resolution: 2371618619 	 0x8d5c073b
</span></span><span style="display:flex;"><span>X Position: 1082452817       0x4084eb51
</span></span><span style="display:flex;"><span>Y Position: 2980145261       0xb1a1686d
</span></span><span style="display:flex;"><span>Serial Number: 686578285826597329
</span></span></code></pre></div><p>先把Serial Number进行进制转换，使用16进制转换到文本字符串，得到hex(X&amp;Ys)，经查询，他的意思是将下x，y的十进制转化为16进制，所以直接转就可以了</p>
<p>python直接运行就可以了</p>
<p>e8a221498d5c073b4084eb51b1a1686d，再套上壳</p>
<h2 id="misc22">misc22<a hidden class="anchor" aria-hidden="true" href="#misc22">#</a></h2>
<p>还是用exif扫了一下，找到了需要的东西，就是这个<strong>Binary data 18195 bytes, use -b option to extract</strong></p>
<p>看到这个是不是莫名的熟悉</p>
<p>好吧，我放弃了</p>
<p>根据这个就可以把他用zsteg给提出去，很神奇</p>
<h2 id="misc23">misc23<a hidden class="anchor" aria-hidden="true" href="#misc23">#</a></h2>
<p>很好，psd文件，不知道是啥，搜一哈，Photoshop</p>
<p>算了，还是用exif吧</p>
<p>ctfshow{49520599-6932-e144-8f4b-dfd5873be5bc}</p>
<p>嘻嘻嘻，出了，美美提交，焯，错了，好难的样子</p>
<p>发现给的这一堆逼数没一点用，还是大佬wp</p>
<h3 id="时间戳">时间戳<a hidden class="anchor" aria-hidden="true" href="#时间戳">#</a></h3>
<blockquote>
<p>1997:09:22 02:17:02+08:00   874865822  3425649e</p>
<p>2055:07:15 12:14:48+08:00</p>
<p>2038:05:05 16:50:45+08:00</p>
<p>1984:08:03 18:41:46+08:00</p>
</blockquote>
<p>利用在线网站转换一下，再转换成16进制，出来的就是了</p>
<h2 id="misc41">misc41<a hidden class="anchor" aria-hidden="true" href="#misc41">#</a></h2>
<h1 id="文件结构">文件结构<a hidden class="anchor" aria-hidden="true" href="#文件结构">#</a></h1>
<p>从这里开始，就来到一个新的篇章了，属于文件结构，就需要修改长宽高来判断了</p>
<h2 id="misc24">misc24<a hidden class="anchor" aria-hidden="true" href="#misc24">#</a></h2>
<p>flag在图片上面，就说明这个图片的高度不够，需要修改高度</p>
<p>通过图片的数据块可以知道图片的宽高在哪里修改，只需要修改高度就可以出来了</p>
<p>将高度处的96改为FA就可以得出来了</p>
<h2 id="misc25">misc25<a hidden class="anchor" aria-hidden="true" href="#misc25">#</a></h2>
<p>首先，这时候最好用kali或者tweakpng打开文件，因为这种隐藏宽高的图片一般是看不出来修改的痕迹，专业工具会更好看出来，比如这一个，就是一个crc的错误，在上面的misc11有，直接还原就可以了</p>
<p>修改高度的话可以和上一题一样，就可以得到flag了</p>
<h2 id="misc26">misc26<a hidden class="anchor" aria-hidden="true" href="#misc26">#</a></h2>
<p>这个说在多下面，我管你多下面，我直接改成FA(250)，你还能有多下面,好吧，真的比这个还下面，我只好改为56ce(22222)了，出了，但是没有完全出</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cftshow{<span style="color:#ae81ff">94</span>aef1<span style="color:#f92672">+</span><span style="color:#66d9ef">True</span> height(hex) of this picture<span style="color:#f92672">+</span><span style="color:#ae81ff">087</span>a7ccf2e28e742efd704c}
</span></span></code></pre></div><p>这一道题需要得到正确的高度并且结合得到flag，出题人，你是个狠人呀。</p>
<p>这时候就得上脚本跑出来正确的高度了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> binascii
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>crcbp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;misc26.png&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>)<span style="color:#f92672">.</span>read()    <span style="color:#75715e">#打开图片</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2000</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2000</span>):
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> crcbp[<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> \
</span></span><span style="display:flex;"><span>            struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>, i)<span style="color:#f92672">+</span>struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>, j)<span style="color:#f92672">+</span>crcbp[<span style="color:#ae81ff">24</span>:<span style="color:#ae81ff">29</span>]
</span></span><span style="display:flex;"><span>        crc32 <span style="color:#f92672">=</span> binascii<span style="color:#f92672">.</span>crc32(data) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffffffff</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(crc32 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xEC9CCBC6</span>):    <span style="color:#75715e">#图片当前CRC</span>
</span></span><span style="display:flex;"><span>            print(i, j)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;hex:&#39;</span>, hex(i), hex(j))
</span></span></code></pre></div><p>先找到crc32值</p>
<p>这个是在图片的后面，先把5个字节跳过去，然后后面的4个字节就是就是crc32的值，带进去爆破出来就可以了。</p>
<p>然后再代入hex函数</p>
<h2 id="misc27">misc27<a hidden class="anchor" aria-hidden="true" href="#misc27">#</a></h2>
<p>答案在图片下面，那还是老规矩呗，直接打开宽高位修改图片，但是发现宽高位的不是宽高，这就要利用到我们的搜索能力了，打开图片属性，将图片的宽高转化为16进制，然后再010里面搜索，就可以很轻易的搜到了，然后再将图片的高改为和宽一样，flag就出来了，当然这个高度随便改，能把下面的flag给显示出来就可以了</p>
<h1 id="gif">gif<a hidden class="anchor" aria-hidden="true" href="#gif">#</a></h1>
<h2 id="文件头部分header">文件头部分(Header)<a hidden class="anchor" aria-hidden="true" href="#文件头部分header">#</a></h2>
<h4 id="gif署名和版本号">GIF署名和版本号<a hidden class="anchor" aria-hidden="true" href="#gif署名和版本号">#</a></h4>
<p>GIf署名来判断一个文件是不是gif文件，这一部分由三个字符组成，文件版本号也是由3个字符组成，一般为87a，或者为89a</p>
<p><img loading="lazy" src="/img/7.png" alt="img"  />
</p>
<h4 id="gif数据流部分">GIF数据流部分<a hidden class="anchor" aria-hidden="true" href="#gif数据流部分">#</a></h4>
<h5 id="逻辑屏幕标识符logical-screen-descriptor">逻辑屏幕标识符(Logical Screen Descriptor)<a hidden class="anchor" aria-hidden="true" href="#逻辑屏幕标识符logical-screen-descriptor">#</a></h5>
<p>这一部分由7个字节组成，定义了GIF图象的大小（高和宽之类）、颜色深度(Color Bits)、背景色(Blackground ColorIndex)以及有无全局颜色列表(Global Color Table)和颜色列表的索引数(ndex Count)</p>
<p>具体描述见下表:</p>
<p><img loading="lazy" src="https://image.3001.net/images/20230508/1683517535_6458705f3a308796a2ff4.png!small?1683517535812" alt="1683517535_6458705f3a308796a2ff4.png!small?1683517535812"  />
</p>
<p>目前只是需要这些，还有一些理论知识，还是得结合题目去研究</p>
<h3 id="考点">考点<a hidden class="anchor" aria-hidden="true" href="#考点">#</a></h3>
<ul>
<li>修补文件头</li>
<li>空间轴隐藏信息</li>
<li>时间轴隐藏信息</li>
</ul>
<h4 id="修复文件头">修复文件头<a hidden class="anchor" aria-hidden="true" href="#修复文件头">#</a></h4>
<p>这种基本还好，结合上面的文件头部信息，只需要找到一张标准的gif文件,对照进行修补就可以了。</p>
<h4 id="空间轴隐藏信息">空间轴隐藏信息<a hidden class="anchor" aria-hidden="true" href="#空间轴隐藏信息">#</a></h4>
<p>由于gif文件的特性，由一帧一帧文件组成，<strong>所以每一帧的图片，或者多张图片的结合，都可以隐藏信息</strong></p>
<p>gif的每一帧的宽高都得进行修改，或者进行分离，找出带有flag的那一帧</p>
<h5 id="解决方式">解决方式<a hidden class="anchor" aria-hidden="true" href="#解决方式">#</a></h5>
<ul>
<li>使用stesolvefj打开图片，Stegsolve Analyse-Frame Brower进行分帧，进行逐帧分析</li>
<li>可以使用conwert命令逐帧分开</li>
<li>convert persistant.gif transparent white result.gif</li>
</ul>
<h3 id="时间轴隐藏信息">时间轴隐藏信息<a hidden class="anchor" aria-hidden="true" href="#时间轴隐藏信息">#</a></h3>
<p>每一帧的时间间隔也可以隐藏信息</p>
<h4 id="解决-1">解决<a hidden class="anchor" aria-hidden="true" href="#解决-1">#</a></h4>
<p>通过工具的利用，来获得时间的间隔</p>
<p>identify命令清晰的打打印出每一顿的时间间隔<code> identify -format&quot;%Tn”100.gif</code>根据时间间隔的规律解决题目</p>
<h2 id="misc28">misc28<a hidden class="anchor" aria-hidden="true" href="#misc28">#</a></h2>
<p>这次的图片是gif文件，可能这个文件有点不同，需要特殊修改，所以在网上看了一下</p>
<p>这个图片的宽高信息与其他的图片不同，所以搜索找到修改就可以了</p>
<p><strong>利用模板</strong>，每次在打开新的图片文件的时候，010都会加载模板，这种模板可以大大的降低难度，因为模板可以显示出图片的信息，更为方便的修改，当然得是一个好的图片</p>
<p><img loading="lazy" src="/img/8.png" alt="img"  />
</p>
<p>修改了以后，打开图片还是老样子，根本就不显示，flag，再在题目中搜索，发现只是改了一处地方，另一处的宽高并没有修改，可能是因为这是一张动图的原因，不太了解</p>
<p><strong>tip</strong>确实如此，gif的每一帧的宽高都得进行修改，或者进行分离，找出带有flag的那一帧</p>
<p>所以这一得长个教训，以后改的话最好还是用搜索，因为在你不知道这个图片格式的情况下，即使你有模板，也不一顶能够完全的正确。</p>
<h2 id="misc29">misc29<a hidden class="anchor" aria-hidden="true" href="#misc29">#</a></h2>
<p>这一次的图片是10帧，就必须利用工具逐帧分析了，<strong>可以利用stegsolve工具</strong></p>
<p>在这之前，还需要先修改一下他的宽高，因为是10张图片，所以需要修改10次，gif的每一帧的宽高都得进行修改，或者进行分离，找出带有flag的那一帧，这里我就用的替换，将96 00全部替换为 84 03，这样的话就可以找到flag了。</p>
<h2 id="misc30">misc30<a hidden class="anchor" aria-hidden="true" href="#misc30">#</a></h2>
<p>这张图是bmp，并且被拉宽了，题目提示是直接修改宽度，可能是个开胃菜</p>
<p>确实只是个开胃菜，套用了一下模板，找到了宽度修改以后就出来了</p>
<h2 id="misc31">misc31<a hidden class="anchor" aria-hidden="true" href="#misc31">#</a></h2>
<p>明说了，高度正确，宽度不对，基本得跑脚本了，当然也可以自己计算，网上也有</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> zlib
</span></span><span style="display:flex;"><span>f <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;./misc31.bmp&#39;</span>,<span style="color:#e6db74">&#39;rb&#39;</span>)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>width <span style="color:#f92672">=</span> c[<span style="color:#ae81ff">18</span>:<span style="color:#ae81ff">22</span>]
</span></span><span style="display:flex;"><span>height <span style="color:#f92672">=</span> c[<span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">26</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 爆破bmp宽度</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">900</span>,<span style="color:#ae81ff">1100</span>):<span style="color:#75715e">#规定大概宽度区间</span>
</span></span><span style="display:flex;"><span>    f1 <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;./bpout/&#39;</span><span style="color:#f92672">+</span>str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.bmp&#39;</span>,<span style="color:#e6db74">&#39;wb&#39;</span>)   <span style="color:#75715e">#需要创建一个名为bpout的文件夹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print(struct.pack(&#39;&gt;i&#39;,i)[::-1])</span>
</span></span><span style="display:flex;"><span>    img <span style="color:#f92672">=</span> c[:<span style="color:#ae81ff">18</span>]<span style="color:#f92672">+</span>struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>,i)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>c[<span style="color:#ae81ff">22</span>:]
</span></span><span style="display:flex;"><span>    f1<span style="color:#f92672">.</span>write(img)
</span></span><span style="display:flex;"><span>    f1<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><p>这个脚本本质也很简单，就是生成了100张图片，让你看看哪个是对的，找了找，发现是1082，出了</p>
<h2 id="misc32">misc32<a hidden class="anchor" aria-hidden="true" href="#misc32">#</a></h2>
<p>只高爆宽，我上脚本了，会的可以计算一下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> zlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 同时爆破宽度和高度</span>
</span></span><span style="display:flex;"><span>filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;misc32.png&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(filename, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    all_b <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> bytearray(all_b[<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">29</span>])
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> <span style="color:#ae81ff">4095</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> w <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>        width <span style="color:#f92672">=</span> bytearray(struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>, w))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> h <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>            height <span style="color:#f92672">=</span> bytearray(struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>, h))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>                data[x<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> width[x]
</span></span><span style="display:flex;"><span>                data[x<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> height[x]
</span></span><span style="display:flex;"><span>            crc32result <span style="color:#f92672">=</span> zlib<span style="color:#f92672">.</span>crc32(data)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#替换成图片的crc</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> crc32result <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xE14A4C0B</span>:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#34;宽为：&#34;</span>, end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>                print(width, end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>                print(int<span style="color:#f92672">.</span>from_bytes(width, byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;big&#39;</span>), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>                print(hex(int<span style="color:#f92672">.</span>from_bytes(width, byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;big&#39;</span>)))
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#34;高为：&#34;</span>, end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>                print(height, end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>                print(int<span style="color:#f92672">.</span>from_bytes(height, byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;big&#39;</span>), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>                print(hex(int<span style="color:#f92672">.</span>from_bytes(height, byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;big&#39;</span>)))
</span></span><span style="display:flex;"><span>         <span style="color:#75715e">#       sys.exit()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#如果加上可以立即结束程序，但是有利有弊吧</span>
</span></span></code></pre></div><blockquote>
<p>宽为：bytearray(b&rsquo;\x00\x00\x04\x14&rsquo;) 1044
高为：bytearray(b&rsquo;\x00\x00\x00\x96&rsquo;) 150</p>
<p>宽为：bytearray(b&rsquo;\x00\x00\x04\x14&rsquo;) 1044 0x414
高为：bytearray(b&rsquo;\x00\x00\x00\x96&rsquo;) 150 0x96</p>
</blockquote>
<p>ok,改一下，最好让他自己改为16进制，&mdash;chatgpt yyds</p>
<h2 id="misc33">misc33<a hidden class="anchor" aria-hidden="true" href="#misc33">#</a></h2>
<p>怎么说呢，逼着人用脚本。</p>
<blockquote>
<p>宽为：bytearray(b&rsquo;\x00\x00\x03\xd2&rsquo;) 978 0x3d2
高为：bytearray(b&rsquo;\x00\x00\x00\x8e&rsquo;) 142 0x8e</p>
</blockquote>
<h2 id="misc34">misc34<a hidden class="anchor" aria-hidden="true" href="#misc34">#</a></h2>
<p>不得不说，出题人真的丧心病狂，狗急跳墙，crc也改了，这让我怎么爆破，看看上面的crc修复吧</p>
<p>哦，大概知道了，高度知道，宽度大于900，那就直接用上面的生成200张不就好了</p>
<p>对了，上面的是bmp脚本，这是需要修改一下二进制的宽高位置，我直接用chatgpt生成了，只能说yyds</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span>f <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;misc34.png&#39;</span>,<span style="color:#e6db74">&#39;rb&#39;</span>)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>chunk_width <span style="color:#f92672">=</span> c[<span style="color:#ae81ff">16</span>:<span style="color:#ae81ff">20</span>]
</span></span><span style="display:flex;"><span>chunk_height <span style="color:#f92672">=</span> c[<span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">24</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 爆破png宽度</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">900</span>,<span style="color:#ae81ff">1300</span>): <span style="color:#75715e">#规定大概宽度区间</span>
</span></span><span style="display:flex;"><span>    f1 <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;output/&#39;</span> <span style="color:#f92672">+</span> str(i) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;.png&#39;</span>,<span style="color:#e6db74">&#39;wb&#39;</span>)
</span></span><span style="display:flex;"><span>    width <span style="color:#f92672">=</span> struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;i&#39;</span>, i)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 修改宽度信息</span>
</span></span><span style="display:flex;"><span>    img <span style="color:#f92672">=</span> c[:<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> width <span style="color:#f92672">+</span> c[<span style="color:#ae81ff">20</span>:]
</span></span><span style="display:flex;"><span>    f1<span style="color:#f92672">.</span>write(img)
</span></span><span style="display:flex;"><span>    f1<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><h2 id="misc35">misc35<a hidden class="anchor" aria-hidden="true" href="#misc35">#</a></h2>
<p>这一道也是直接爆破，但是他有一个小小的很很可爱，因为他的高度不够，所以这里是埋了坑的，爆破前先吧高度给改了。  他这个宽高还是藏了的，所以搜一下03 84，常规操作。但是也有一点，他这个是jpg文件，新的脚本爆破一下吧</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> zlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span>filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;misc35.jpg&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(filename, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    all_b <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#w = all_b[159:161]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#h = all_b[157:159]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">901</span>,<span style="color:#ae81ff">1200</span>):
</span></span><span style="display:flex;"><span>        name <span style="color:#f92672">=</span> str(i) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.jpg&#34;</span>
</span></span><span style="display:flex;"><span>        f1 <span style="color:#f92672">=</span> open(name,<span style="color:#e6db74">&#34;wb&#34;</span>)
</span></span><span style="display:flex;"><span>        im <span style="color:#f92672">=</span> all_b[:<span style="color:#ae81ff">159</span>]<span style="color:#f92672">+</span>struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;h&#39;</span>,i)<span style="color:#f92672">+</span>all_b[<span style="color:#ae81ff">161</span>:]
</span></span><span style="display:flex;"><span>        f1<span style="color:#f92672">.</span>write(im)
</span></span><span style="display:flex;"><span>        f1<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><blockquote>
<p>这个Python脚本以二进制读取模式打开JPEG图像文件“misc35.jpg”，它尝试通过暴力破解来查找正确的宽度值。它遍历901到1200之间的所有宽度值，并在每次循环中创建一个新的JPEG文件。对于每个i值，它将缓存的原始图像数据读入内存（名为&rsquo;all_b&rsquo;），并使用struct.pack将新的宽度值编码为2字节的无符号整数。然后，它使用切片操作构建一个新的JPEG图片数据，将新的宽度值插入到正确位置上，并将其写入到新的JPEG文件。原始文件不会受到修改。</p>
<p>请注意，JPEG文件结构与PNG文件和BMP文件不同，因此您需要使用不同的字节偏移量来提取JPEG的宽度和高度。在这种情况下，使用了偏移量159-160和161来提取高度和宽度信息。由于JPEG是无损压缩的，因此无需导入zlib库来处理数据。</p>
</blockquote>
<h2 id="misc36">misc36<a hidden class="anchor" aria-hidden="true" href="#misc36">#</a></h2>
<p><strong>出题人坦白从宽，正确的宽度在920-950之间</strong></p>
<p>这么好吗，直接给他奸了，当然不要忘了一件事，那就是他的高度需要改一下，改了改了。不要忘了，得全局修改</p>
<p>好了，可以开始爆破了，或者用crc，这次我要自己写，我说的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> zlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span>image<span style="color:#f92672">=</span>open(<span style="color:#e6db74">&#34;misc36.gif&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">920</span>,<span style="color:#ae81ff">950</span>):
</span></span><span style="display:flex;"><span>   image1<span style="color:#f92672">=</span>open(str(i<span style="color:#f92672">-</span><span style="color:#ae81ff">900</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.gif&#39;</span>,<span style="color:#e6db74">&#39;wb&#39;</span>)
</span></span><span style="display:flex;"><span>   change<span style="color:#f92672">=</span>image[:image<span style="color:#f92672">.</span>index(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x00\x84\x03\x90\x01</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">+</span>struct<span style="color:#f92672">.</span>pack(<span style="color:#e6db74">&#39;&gt;h&#39;</span>,i)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>image[image<span style="color:#f92672">.</span>index(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x00\x84\x03\x90\x01</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>:]
</span></span><span style="display:flex;"><span>   image1<span style="color:#f92672">.</span>write(change)
</span></span><span style="display:flex;"><span>   image1<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><h2 id="misc37">misc37<a hidden class="anchor" aria-hidden="true" href="#misc37">#</a></h2>
<p>一眼看过去一直在闪，第一反应是有很多帧，就是有很多帧，但是不知道为什么我第一次显示的只有1帧，直接用stegsolve打开就可以了，焯</p>
<p>但是打开stegsolve只有一帧。但是打开</p>
<p>010看了一下，肯定不止一帧，因为光是高度就有两个，搜索84 03甚至能搜到3个，基本可以判断是文件头给删了，开头的估计是对的，感觉是后面的出错了，所以对比修复一下</p>
<p><img loading="lazy" src="/img/25.png" alt="img"  />
</p>
<h1 id="apng">APNG<a hidden class="anchor" aria-hidden="true" href="#apng">#</a></h1>
<p>可以动的png文件，只有积累，而且这类图片的一个技巧就是可以在浏览器中打开</p>
<p>而且这个文件中的数据块包含一个 <strong>ftcl</strong>块，在010中也可以看出来。</p>
<h2 id="misc38">misc38<a hidden class="anchor" aria-hidden="true" href="#misc38">#</a></h2>
<p>这是一个会动的apng图片，要使用浏览器才能看出来，whatfu*k！</p>
<p>我怎么知道，而且用stegsolve还看不出来，要用特殊的分离工具上面有提到，无语死</p>
<p><a href="https://zhuanlan.zhihu.com/p/169389838">这篇文章</a>是关于apng的介绍，可以提供一些思路</p>
<p>用工具<code>APNG Disassembler</code>分离，<code>9、17、36、40</code>帧中藏有flag</p>
<h2 id="misc39">misc39<a hidden class="anchor" aria-hidden="true" href="#misc39">#</a></h2>
<p><strong>flag就像水，忽快忽慢地流</strong></p>
<p>怎么说呢，我自己是看不出来的，就是gif三件套，文件头，空间轴，和时间轴，这个gif变化忽快忽慢，这就是时间间隔了。利用工具提取，kali里用命令<code>identify -format &quot;%T &quot; misc39.gif &gt; misc39.txt</code>提取帧数，</p>
<blockquote>
<p>37 37 36 36 36 37 37 37 37 37 36 37 36 36 37 37 36 36 37 37 36 37 37 37 36 36 37 37 37 37 36 37 36 36 36 37 37 36 37 37 37 37 37 37 37 36 37 37 37 37 37 37 37 36 37 37 36 37 37 36 37 36 37 36 37 37 36 36 37 36 36 37 37 37 36 36 36 36 37 37 36 36 36 37 36 37 37 36 36 37 36 37 37 36 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 37 36 37 37 36 37 36 37 37 37 36 36 37 37 36 37 37 36 36 36 37 36 36 37 37 36 37 37 37 37 37 36 36 36 37 36 37 37 36 36 37 36 37 36 37 37 36 36 37 36 36 37 37 36 37 37 36 36 37 37 37 36 36 36 37 37 36 36 37 36 36 36 37 37 37 36 36 37 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 37 36 36 36 36 37 36 37 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 36 37 36 37 37 36 36 36 37 37 37 37 36 36 36 36 37 36 37 37 36 36 36 36 36 37 37 36 37 36 36 36 37 37 36 37 36 37 36 37 37 37 36 36 37 37 37 37 37 37 36 37</p>
</blockquote>
<p>时间间隔就是这些，然后呢，哈哈哈哈哈哈，当然是一个0一个1，你问我那个是0，那个是1，肯定是小的是0大的是1，当然也比较好换，统一减去36就可以了，你问我太多了怎么办，我告诉你写个脚本就可以了，你问我脚本呢，我告诉你我直接用的chatgpt，</p>
<p><img loading="lazy" src="/img/image-20230509230753533.png" alt="image-20230509230753533"  />
</p>
<p>然后放入010里面看看是何方神圣，不对这个二进制直接转化为ascil码，然后转化为字符就可以了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1 1 0 0 0 1 1 1 1 1 0 1 0 0 1 1 0 0 1 1 0 1 1 1 0 0 1 1 1 1 0 1 0 0 0 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 0 1 1 0 1 0 1 0 1 1 0 0 1 0 0 1 1 1 0 0 0 0 1 1 0 0 0 1 0 1 1 0 0 1 0 1 1 0 0 1 1 0 1 1 0 0 1 1 0 0 1 1 1 0 0 1 0 1 1 1 0 0 1 0 1 1 0 1 0 1 1 1 0 0 1 1 0 1 1 0 0 0 1 0 0 1 1 0 1 1 1 1 1 0 0 0 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 0 0 1 1 0 1 1 0 0 1 1 1 0 0 0 1 1 0 0 1 0 0 0 1 1 1 0 0 1 0 1 1 0 1 1 0 0 1 1 0 0 1 1 1 1 0 0 0 0 1 0 1 1 1 0 0 1 1 1 0 0 1 0 1 1 1 0 0 0 1 0 1 1 0 0 0 1 1 1 1 0 0 0 0 1 0 1 1 0 0 0 0 0 1 1 0 1 0 0 0 1 1 0 1 0 1 0 1 1 1 0 0 1 1 1 1 1 1 0 1&#34;</span>
</span></span><span style="display:flex;"><span>flag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>print(s)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">82</span>):
</span></span><span style="display:flex;"><span>	s<span style="color:#f92672">=</span>s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">41</span>):
</span></span><span style="display:flex;"><span>	flag <span style="color:#f92672">+=</span>chr(int(s[<span style="color:#ae81ff">7</span><span style="color:#f92672">*</span>i:<span style="color:#ae81ff">7</span><span style="color:#f92672">*</span>(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)],<span style="color:#ae81ff">2</span>)) <span style="color:#75715e">#二进制，每隔7个二进制转化为ascil码，然后再转化为字符</span>
</span></span><span style="display:flex;"><span>print(flag)
</span></span></code></pre></div><h2 id="misc40">misc40<a hidden class="anchor" aria-hidden="true" href="#misc40">#</a></h2>
<p><strong>flag就像歌，有长有短仿佛岁月悠悠</strong></p>
<p>我就挺好奇的，这些apng图，我怎么才能看出来，直接打开工具给分离一下呗，毕竟都说flag像歌了，</p>
<p>文件分离完成之后，在图片中找不到直接的flag了，但是如何才能找到呢，就要从文本文档入手了，可是这些文本又有什么用呢，打开看了一下，有序号，先用python给提取出</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>flag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">69</span>):
</span></span><span style="display:flex;"><span>	f<span style="color:#f92672">=</span>open(<span style="color:#e6db74">&#39;apngframe&#39;</span><span style="color:#f92672">+</span>str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.txt&#39;</span>)
</span></span><span style="display:flex;"><span>	s<span style="color:#f92672">=</span>f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>	flag <span style="color:#f92672">+=</span> chr(int(s<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">6</span>:]))
</span></span><span style="display:flex;"><span>print(str(flag))
</span></span></code></pre></div><p><img loading="lazy" src="/img/12233112.png" alt="img"  />
</p>
<p>直接运行就出了。但是有一些多余的</p>
<h2 id="misc42">misc42<a hidden class="anchor" aria-hidden="true" href="#misc42">#</a></h2>
<p>flag有多长，不太懂了，也不是个动图，打开010吧，看不出来。</p>
<p>还是得懂得运用工具，我开了一下tweakpng。果然有问题，这个图片有着高达几十的idat块，先尝试删除试试再说。</p>
<p>好吧，删了一堆还是没有变化，再看2cm，41位，肯定都别有深意，</p>
<p><strong>41位</strong>，这是flag的长度值，而且这个的idat块差不多有50个，这时候就要用到刚才说的长度了</p>
<p><strong>2cm</strong>，这个想表达的不是2，而是cm，对应的应该就是这个Length,现在就知道了，就是这一堆数，复制下来，转一下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> [<span style="color:#ae81ff">229</span>,<span style="color:#ae81ff">152</span>,<span style="color:#ae81ff">191</span>,<span style="color:#ae81ff">229</span>,<span style="color:#ae81ff">152</span>,<span style="color:#ae81ff">191</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">99</span>,<span style="color:#ae81ff">116</span>,<span style="color:#ae81ff">102</span>,<span style="color:#ae81ff">115</span>,<span style="color:#ae81ff">104</span>,<span style="color:#ae81ff">111</span>,<span style="color:#ae81ff">119</span>,<span style="color:#ae81ff">123</span>,<span style="color:#ae81ff">48</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">99</span>,<span style="color:#ae81ff">98</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">48</span>,<span style="color:#ae81ff">102</span>,<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">99</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">102</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">101</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">48</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">102</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">99</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">125</span>]
</span></span><span style="display:flex;"><span>flag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a:
</span></span><span style="display:flex;"><span>	flag<span style="color:#f92672">+=</span>chr(i)
</span></span><span style="display:flex;"><span>print(flag)
</span></span></code></pre></div><h2 id="misc43">misc43<a hidden class="anchor" aria-hidden="true" href="#misc43">#</a></h2>
<p><strong>错误中通往这蕴涵正确的道路</strong></p>
<p>这句话很明显了。图片是个错误文件，但是电脑能打开呀，很熟悉，至少我知道的就有一种，那就是crc的错误，拿专业(bushi)工具，或者kali，就会报错，错误的crc for idat</p>
<h5 id="解决-2"><strong>解决</strong><a hidden class="anchor" aria-hidden="true" href="#解决-2">#</a></h5>
<p>第一个是试试修改图片的尺寸，不对，有蹊跷，妈的，不但有错误，还不止一个，首先有很多idat，其次就是基本每个idat都有错误</p>
<p>，而且这次的长度值都一样，可能是crc的编码隐藏信息了。由于这里不好看出来具体是那个crc的错误，所以我先用另一个工具</p>
<h2 id="pngdebugger">pngdebugger<a hidden class="anchor" aria-hidden="true" href="#pngdebugger">#</a></h2>
<p><strong>PNG Debugger</strong> 可以进行读取 PNG 图片的数据，检测各数据块中的 <strong>CRC</strong> 是否正确，在 Windows 下使用。</p>
<p>使用命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>PNGDebugger.exe 文件路径   ---直接打开
</span></span><span style="display:flex;"><span>PNGDebugger.exe misc44.png &gt; 1.txt  --导出来
</span></span></code></pre></div><p><img loading="lazy" src="/img/image-20230510210404584.png" alt="image-20230510210404584"  />
</p>
<p>注意一下，上面的才是crc的值，下面的虽然在tweakpng中有，但是似乎并不是想要的，而上面的才是我们需要的，可能上面的是正确的，不知</p>
<p>我又看了一下，上面的可以在010里面搜到，但是下面的搜不到，所以说明下面的是修正后的，原来的crc，而上面的是被人为制造的，所以也恰恰说明了为什么上面的当中蕴含信息</p>
<blockquote>
<p>E59387E593A62E63746673686F777B36656232353839666666663565333930666536623837353034646263303839327D</p>
</blockquote>
<h2 id="misc44">misc44<a hidden class="anchor" aria-hidden="true" href="#misc44">#</a></h2>
<p>错误中还有坑，那就是好消息，和上一道题一样呗，可能这道题，需要将图片修复，先用pngdebugger跑一下，还是有对有错，可能是因为不是全错的，这样的话就有很大的问题，因为正确的crc是自动生成的，不可能隐藏信息，所以只能把出错的找出来</p>
<p>发现和上一题差的其实挺多的，因为这里有100多个错误的idat，就算全部都给他提取出来的话也太多了。所以考虑到了二进制，因为OK和FAILED可以作为0和1，至于哪个是0，那个是1，试一试呗，反正也就两种。至于怎么提取出来，还是得利用chatgpt</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;1.txt&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    lines <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>readlines()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>, len(lines), <span style="color:#ae81ff">6</span>): <span style="color:#75715e"># starting at line 6, increment by 6</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;OK&#34;</span> <span style="color:#f92672">in</span> lines[i]:
</span></span><span style="display:flex;"><span>        output <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;FAILED&#34;</span> <span style="color:#f92672">in</span> lines[i]:
</span></span><span style="display:flex;"><span>        output <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>print(hex(int(output,<span style="color:#ae81ff">2</span>))[<span style="color:#ae81ff">2</span>:])
</span></span></code></pre></div><p>此代码指定了一个以5为起点，以每6个为步长的范围，该范围包括名为1.txt的文本文件中的第六行和其倍数的行。 对于每个行索引（即<code>i</code>），代码检查该行是否包含<code>OK</code>或<code>FAILED</code>。如果找到了相应的标记，则代码将&quot;0&quot;或&quot;1&quot;添加到输出字符串。</p>
<p>但是上面的代码存在错误，就是将二进制转化为了16进制，这样的得到的并不是正确答案，再转字符串就好了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;1.txt&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    lines <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>readlines()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>binary_string <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>, len(lines), <span style="color:#ae81ff">6</span>): <span style="color:#75715e"># starting at line 6, increment by 6</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;OK&#34;</span> <span style="color:#f92672">in</span> lines[i]:
</span></span><span style="display:flex;"><span>        binary_string <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;FAILED&#34;</span> <span style="color:#f92672">in</span> lines[i]:
</span></span><span style="display:flex;"><span>        binary_string <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>text_string <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(binary_string), <span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>    byte <span style="color:#f92672">=</span> binary_string[j:j<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>]
</span></span><span style="display:flex;"><span>    decimal <span style="color:#f92672">=</span> int(byte, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    character <span style="color:#f92672">=</span> chr(decimal)
</span></span><span style="display:flex;"><span>    text_string <span style="color:#f92672">+=</span> character
</span></span><span style="display:flex;"><span>print(text_string)
</span></span></code></pre></div><h2 id="二进制转字符串16进制转字符串之类的python脚本">二进制转字符串，16进制转字符串之类的python脚本<a hidden class="anchor" aria-hidden="true" href="#二进制转字符串16进制转字符串之类的python脚本">#</a></h2>
<h2 id="misc45">misc45<a hidden class="anchor" aria-hidden="true" href="#misc45">#</a></h2>
<p>说是换一种思维方式，估计是换题型了。图片混不拉基的，看看是不是idat的问题，这个没问题，但是确实不太一样，打开tweakpng确实藏着一些东西，但是不太明白是什么。搜一搜了得</p>
<p>怎么说呢，正确的做法是将这个文件转化为bmp文件再接着做，题目中也有提示，就是尝试思维<strong>格式</strong>，转换网站<a href="https://cdkm.com/cn/png-to-bmp">网站可以在此</a>，然后在拉进binwalk分析，有个flag.png,拿出来就ok了</p>
<p>其实这一道题，拿到tweak打开时，会显示bmp的一些信息，<img loading="lazy" src="/img/image-20230511115229355.png" alt="image-20230511115229355"  />
这个8bit的深度转换，是bmp的一个明显的特征。</p>
<h2 id="misc46">misc46<a hidden class="anchor" aria-hidden="true" href="#misc46">#</a></h2>
<p>打开是个gif动图，先逐帧看一下，看了一下没有动，问题应该不在那里，先看看题目要求</p>
<p>直接看了看wp，实在没有什么思路，也算是对gif提题型的一种补充。用identify提取他的详细信息，<code>identify misc46.gif &gt;1.txt</code>然后接下来就把他里面的坐标偏移量提取出来，利用画图工具输出<strong>gnuplot</strong></p>
<h2 id="misc47">misc47<a hidden class="anchor" aria-hidden="true" href="#misc47">#</a></h2>
<p>那你知道笔仙吗，不知道，然后这又是一张apng，直接分解看看有没有信息，563张，和上一道题的帧数一样，可能差不多，直接打开来看看。都是100，看来这个delay值的作用不大了，去别的地方看看吧，<a href="https://zhuanlan.zhihu.com/p/169389838">这篇文章</a>是关于apng的介绍，可以提供一些思路。简单来说就是每一个<code>IDAT块</code>前面都会有一个<code>fcTL块</code>，它其中就包含<strong>水平垂直偏移量</strong>，然后就写个代码，将里面的所有偏移量提取出来。我的大致思路，是将文件的16进制读取到文本中，然后把相应位置的数据提出来，因为每个</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>print(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>im <span style="color:#f92672">=</span>Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;RGB&#39;</span>,(<span style="color:#ae81ff">400</span>,<span style="color:#ae81ff">80</span>),<span style="color:#ae81ff">255</span>)
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">=</span>open(<span style="color:#e6db74">&#39;output.txt&#39;</span>,<span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#75715e">#将图片的16制文件保存到这里，全选ctrl+shift+a就可以复制了</span>
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span>f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>print(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>It <span style="color:#f92672">=</span>c<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;6663544C&#34;</span>)<span style="color:#75715e">#这段代码将字符串变量c按照字符串&#34;6663544C(fcTL)&#34;分割成一个列表变量lt。该字符串&#34;6663544C&#34;是用作分割符的特定字符串，根据实际数据格式可以进行更改。分割后，列表lt中的每个元素都是原始字符串中包含两个16进制坐标数据的子字符串。在后续代码中，程序通过解析并提取这些坐标数据，来处理或操作原始数据。</span>
</span></span><span style="display:flex;"><span>print(len(It),len(c))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">493</span>):
</span></span><span style="display:flex;"><span>	x<span style="color:#f92672">=</span>int(It[i][<span style="color:#ae81ff">28</span>:<span style="color:#ae81ff">32</span>],<span style="color:#ae81ff">16</span>)<span style="color:#75715e">#找到x的偏移，取6663544C后的第28到31个字节，16是16进制，用于int的转化为整形</span>
</span></span><span style="display:flex;"><span>	y<span style="color:#f92672">=</span>int(It[i][<span style="color:#ae81ff">36</span>:<span style="color:#ae81ff">40</span>],<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>	im<span style="color:#f92672">.</span>putpixel((x,y))
</span></span></code></pre></div><h2 id="misc48">misc48<a hidden class="anchor" aria-hidden="true" href="#misc48">#</a></h2>
<p><strong>附件的第（Di）七（Qi）题（Ti）中有提示。本题略脑洞，可跳过</strong></p>
<p>首先这是一个jpg，看里面可能有exif信息，打开exitool看一下，没有什么。然后就注意题目，其实jpg中有个模块是DQT，选中查看，</p>
<p><img loading="lazy" src="/img/image-20230513094849037.png" alt="image-20230513094849037"  />
</p>
<p>**ctfshow{32}**在题目中可以看到这个，那就知道了大体框架和字母的数字，然后再去看DQT模块的玄机。可以看到有很多FF，就要从就能从这个入手了</p>
<h2 id="misc49">misc49<a hidden class="anchor" aria-hidden="true" href="#misc49">#</a></h2>
<p><strong>它们一来就是十六种。本题略脑洞，可跳过</strong></p>
<p>这是一个jpg图片，打开exif没有什么有用的信息，麻了，看了wp之后，再做一做。</p>
<p>首先里面有很多字符串，看看他们的共同之处，他们共同点就是前面都有FF Ed的16进制</p>
<p>​                0c618671a13f5da394fb2a2238e44</p>
<p>ctfshow{0c618671a153f5da3948fdb2a2238e44}</p>
<h2 id="misc50">misc50<a hidden class="anchor" aria-hidden="true" href="#misc50">#</a></h2>
<p><strong>有时候视线需要放低一点</strong></p>
<p>需要用stegsolve不停的切换图片通道就可以了。</p>
<h2 id="misc51">misc51<a hidden class="anchor" aria-hidden="true" href="#misc51">#</a></h2>
<p><strong>你会数数吗</strong></p>
<h2 id="misc52">misc52<a hidden class="anchor" aria-hidden="true" href="#misc52">#</a></h2>
<p>麻了，实在搞不懂</p>
<h1 id="lsb">LSB<a hidden class="anchor" aria-hidden="true" href="#lsb">#</a></h1>
<h2 id="misc53">misc53<a hidden class="anchor" aria-hidden="true" href="#misc53">#</a></h2>
<p><strong>开始愉快的LSB</strong></p>
<p>确实愉快，直接开干吧，基础的LSB隐写，打开stegsolve，打开data extract，勾选red green blue的0位，然后勾选LSB first，就可以看到了</p>
<h2 id="misc54">misc54<a hidden class="anchor" aria-hidden="true" href="#misc54">#</a></h2>


        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://modesty258.github.io/posts/python/%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">
    <span class="title">« 上一页</span>
    <br>
    <span>基础语法</span>
  </a>
  <a class="next" href="https://modesty258.github.io/posts/misc/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/">
    <span class="title">下一页 »</span>
    <br>
    <span>图片隐写</span>
  </a>
</nav>

        </footer>
    </div>

<style>
    .comments_details summary::marker {
        font-size: 20px;
        content: '👉展开评论';
        color: var(--content);
    }
    .comments_details[open] summary::marker{
        font-size: 20px;
        content: '👇关闭评论';
        color: var(--content);
    }
</style>


<div>
    <details class="comments_details">
        <summary style="cursor: pointer; margin: 50px 0 20px 0;width: 130px;">
            <span style="font-size: 20px;color: var(--content);">...</span>
        </summary>
        <div id="tcomment"></div>
    </details>
    <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js">
    </script>
    <script>
        twikoo.init({
            envId:  null ,
        el: "#tcomment",
            lang: 'zh-CN',
            region:  null ,
        path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        })
    </script>
</div>
</article>
</main>

<footer class="footer">
    <span>
        Copyright
        &copy;
        2020-2023
        <a href="https://modesty258.github.io/" style="color:#939393;">Modest&#39;s Blog</a>
        All Rights Reserved
    </span>
    <a href="https://beian.miit.gov.cn/" target="_blank" style="color:#939393;"></a>&nbsp;
    <span>
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null"
           style="display:inline-block;text-decoration:none;height:20px;color:#939393;">
            <img src="" style="float:left;margin: 0px 5px 0px 0px;"/>
            
        </a>
    </span>
    <span id="busuanzi_container">
        <span class="fa fa-user"></span> <span id="busuanzi_value_site_uv"></span>
        <span class="fa fa-eye"></span> <span id="busuanzi_value_site_pv"></span>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"Modest's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"Modest's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = '📄复制';

        function copyingDone() {
            copybutton.innerText = '👌🏻已复制!';
            setTimeout(() => {
                copybutton.innerText = '📄复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\n————————————————\r\n' +
                    '版权声明：本文为「'+"Modest's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>

<script>
    $("code[class^=language] ").on("mouseover", function () {
        if (this.clientWidth < this.scrollWidth) {
            $(this).css("width", "135%")
            $(this).css("border-top-right-radius", "var(--radius)")
        }
    }).on("mouseout", function () {
        $(this).css("width", "100%")
        $(this).css("border-top-right-radius", "unset")
    })
</script>
</body>

</html>
