<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>图片隐写 | Modest&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="师傅 [挺好的]http://www.ga1axy.top/index.php/archives/6/#0x01%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3 图片隐写术 元数据隐写 隐藏在图片的属性中，一般直接属性查看，或者用命令 strings：打印可直接打印">
<meta name="author" content="Modest">
<link rel="canonical" href="https://modesty258.github.io/posts/misc/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://modesty258.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://modesty258.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://modesty258.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://modesty258.github.io/img/Q.gif">
<link rel="mask-icon" href="https://modesty258.github.io/img/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta property="og:title" content="图片隐写" />
<meta property="og:description" content="师傅 [挺好的]http://www.ga1axy.top/index.php/archives/6/#0x01%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3 图片隐写术 元数据隐写 隐藏在图片的属性中，一般直接属性查看，或者用命令 strings：打印可直接打印" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://modesty258.github.io/posts/misc/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-04T21:06:52+08:00" />
<meta property="article:modified_time" content="2023-05-04T21:06:52+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="图片隐写"/>
<meta name="twitter:description" content="师傅 [挺好的]http://www.ga1axy.top/index.php/archives/6/#0x01%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3 图片隐写术 元数据隐写 隐藏在图片的属性中，一般直接属性查看，或者用命令 strings：打印可直接打印"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "📚文章",
          "item": "https://modesty258.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "📚misc",
          "item": "https://modesty258.github.io/posts/misc/"
        }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "图片隐写",
      "item": "https://modesty258.github.io/posts/misc/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "图片隐写",
  "name": "图片隐写",
  "description": "师傅 [挺好的]http://www.ga1axy.top/index.php/archives/6/#0x01%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3 图片隐写术 元数据隐写 隐藏在图片的属性中，一般直接属性查看，或者用命令 strings：打印可直接打印",
  "keywords": [
    ""
  ],
  "articleBody": "师傅\n[挺好的]http://www.ga1axy.top/index.php/archives/6/#0x01%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3\n图片隐写术 元数据隐写 隐藏在图片的属性中，一般直接属性查看，或者用命令\nstrings：打印可直接打印的字符，可以发现隐藏的压缩包注释内容或者解压密码\ninentify：用于获取一个或多个图像文件的格式和特征，用于提取指定数据\npng图片 文件格式：文件头固定，剩下的有数据块组成\n文件头：89 50 4E 47 0D 0A 1A 0A + 数据块 + 数据块 + 数据块\nIHDR 文件头数据块，包含png图片的基本信息，由13个字节组成，只需要关注前八个字节包含宽和高\n经常会通过更改一张图片的高和宽来隐藏一些信息\nkali一般会打不开，提示文件错误，而在windows中可以打开，一般是修改了宽和高\nwp IDAT（图像数据块） IDAT隐写 使用pngcheck分析 pngcheck.exe -v file 判断异常IDAT串，使用winhex等工具创建新文件 根据创建后的新文件继续分析 IDAT：存储实际的数据，在数据流中可包含多个连续顺序的图像数据块。\n储存图像像数数据。 在数据流中可包含多个连续顺序的图像数据块。 采用 LZ77 算法的派生算法进行压缩。 可以用 zlib 解压缩。 *** IDAT块只有当上一个块充满时，才会继续下一个新块。***\nIEND 图像结束数据 IEND（image trailer chunk）：它用来标记 PNG 文件或者数据流已经结束，并且必须要放在文件的尾部。\n00 00 00 00 49 45 4E 44 AE 42 60 82 END 数据块的长度总是 00 00 00 00 ，数据标识总是 IEND 49 45 4E 44，因此，CRC 码也总是 AE 42 60 82。\nlsb隐写 LSB隐写，也就是最低有效位，图片中的像数一般是由三原色组成，这三原色也可以组成别的颜色。在png图片的存储中，每个颜色会有8bit，LSB隐写就是修改像数中最低的1bit，写入加密信息\n三原色为红蓝绿，每个颜色的二进制都为八位，那么转化为十进制就有256种，这三种的随机组合就有256的三次方，达到了很多位，正常眼睛就无法识别，那么就可以修改最低的二进制位然后来隐藏信息，最多可以隐藏3bit的信息而使图片没有变化(人眼无法识别)\n上图我们可以看到，十进制的235表示的是绿色，我们修改了在二进制中的最低位，但是颜色看起来依旧没有变化。我们就可以修改最低位中的信息，实现信息的隐写。我修改最低有效位的信息的算法就叫做lsb加密算法，提取最低有效位信息的算法叫做lsb解密算法\njpg jphide F5 outguess 盲水印 相同的图片是异或或者盲水印，还有酷似的二维码。\n异或 作图题 出现大量的010100，可能是二维码\n或者有很多的坐标，需要用到绘制，可以使用脚本。一般出现在gif和apng中，这类分离之后，会出现数据，或者在010中可以寻找到x，y。\n拼图 有一张打乱的图，还有一张原图，打乱的图里面可能包含着flag，使用gaps\nstegdetect (win) （检查jpg图片隐写方法,Stegdetect可以检测到通过JSteg、JPHide、OutGuess、Invisible Secrets、F5、appendX和Camouflage等这些隐写工具隐藏的信息）将图片复制到 stegdetect.exe 所在文件夹，打开 cmd 输入：\nstegdetect.exe -tjopi -s 10.0 [stego_file]\n-s 修改检测算法的敏感度，该值的默认值为1。检测结果的匹配度与检测算法的敏感度成正比，算法敏感度的值越大，检测出的可疑文件包含敏感信息的可能性越大。 -t 设置要检测哪些隐写工具（默认检测jopi），可设置的选项如下： j检测图像中的信息是否是用jsteg嵌入的。 o 检测图像中的信息是否是用outguess嵌入的。 p 检测图像中的信息是否是用jphide嵌入的。 i 检测图像中的信息是否是用invisible secrets嵌入的\nsteghide(win)\n查看图片中嵌入的文件信息：\nsteghide info out.jpg\n提取含有密码的隐藏内容：\nsteghide extract -sf out.jpg -p 123456\n提取不含有密码的隐藏内容：\nsteghide extract -sf out.jpg\nsteghide爆破密码\n有些题目用steghide加密文件但是不给密码，此时就需要爆破，steghide本身并不支持爆破，需要一些其他的方法： https://github.com/Va5c0/Steghide-Brute-Force-Toolpython\nsteg_brute.py -b -d [字典] -f [jpg_file]\nF5\n(F5隐写，需要passwd）\n在kail下切换到F5-steganography，在java Extract运行命令：\njava Extract 123456.jpg图片的绝对地址 -p 123456\noutguess\n(kali下图片隐写+可需要可不要passwd）\noutguess -r /root/angrybird.jpg(绝对路径) 123.txt(信息存放的文本) outguess -k 12345 -r 2.jpg out.txt -k后接密码 -r后接解密图片 输出文件\n",
  "wordCount" : "1801",
  "inLanguage": "en",
  "datePublished": "2023-05-04T21:06:52+08:00",
  "dateModified": "2023-05-04T21:06:52+08:00",
  "author":[{
    "@type": "Person",
    "name": "Modest"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://modesty258.github.io/posts/misc/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Modest's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://modesty258.github.io/img/Q.gif"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://modesty258.github.io/" accesskey="h" title="Modest&#39;s Blog (Alt + H)">
            <img src="https://modesty258.github.io/img/Q.gif" alt="logo" aria-label="logo"
                 height="35">Modest&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://modesty258.github.io/search" title="🔍 搜索 (Alt &#43; /)" accesskey=/>
                <span>🔍 搜索</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/" title="🏠 主页">
                <span>🏠 主页</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/posts" title="📚 文章">
                <span>📚 文章</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/tags" title="🧩 标签">
                <span>🧩 标签</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/archives/" title="⏱️ 时间轴">
                <span>⏱️ 时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/about" title="🙋🏻‍♂️ 关于">
                <span>🙋🏻‍♂️ 关于</span>
                </a>
            </li>
            <li>
                <a href="https://modesty258.github.io/links" title="🤝 友链">
                <span>🤝 友链</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="https://modesty258.github.io/">🏠 主页</a>&nbsp;»&nbsp;<a href="https://modesty258.github.io/posts/">📚文章</a>&nbsp;»&nbsp;<a href="https://modesty258.github.io/posts/misc/">📚misc</a></div>
            <h1 class="post-title">
                图片隐写
            </h1>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2023-05-04
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>1801字
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>4分钟
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>Modest
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    <span id="post_meta_style_8">
                        <span class="fa fa-commenting-o"></span>
                        <span>
                            <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js"></script>
                            <script>
                                let url = document.documentURI
                                
                                let dnsUrl = "https://modesty258.github.io/"
                                let urlSplit = url.split(dnsUrl)
                                let finalUrl = urlSplit[1]
                                if (finalUrl[0] !== '/') {
                                    finalUrl = '/'+finalUrl
                                }
                                twikoo.getCommentsCount({
                                    envId:  null , 
                                region:  null , 
                                urls: [ 
                                    
                                    finalUrl,
                                ],
                                    includeReply: false 
                                }).then(function (res) {
                                    let count = res[0].count
                                    const obj = document.getElementById("comment_count");
                                    obj.innerText = count
                                    
                                    
                                    
                                }).catch(function (err) {
                                    
                                    console.error(err);
                                });
                            </script>
                            <span id="comment_count"></span>
                        </span>
                    </span>
                </span>

</div>
        </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">文章目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e5%9b%be%e7%89%87%e9%9a%90%e5%86%99%e6%9c%af" aria-label="图片隐写术">图片隐写术</a><ul>
                            
                    <li>
                        <a href="#%e5%85%83%e6%95%b0%e6%8d%ae%e9%9a%90%e5%86%99" aria-label="元数据隐写">元数据隐写</a><ul>
                            
                    <li>
                        <a href="#png%e5%9b%be%e7%89%87" aria-label="png图片">png图片</a><ul>
                            
                    <li>
                        <a href="#ihdr" aria-label="IHDR">IHDR</a><ul>
                            
                    <li>
                        <a href="#wp" aria-label="wp">wp</a></li></ul>
                    </li>
                    <li>
                        <a href="#idat%e5%9b%be%e5%83%8f%e6%95%b0%e6%8d%ae%e5%9d%97" aria-label="IDAT（图像数据块）"><strong>IDAT（图像数据块）</strong></a></li></ul>
                    </li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#idat%e9%9a%90%e5%86%99" aria-label="IDAT隐写">IDAT隐写</a><ul>
                            <ul>
                            <ul>
                            
                    <li>
                        <a href="#iend" aria-label="IEND"><strong>IEND</strong></a></li></ul>
                        
                    <li>
                        <a href="#lsb%e9%9a%90%e5%86%99" aria-label="lsb隐写">lsb隐写</a></li></ul>
                        </ul>
                    </li>
                    <li>
                        <a href="#jpg" aria-label="jpg">jpg</a><ul>
                            
                    <li>
                        <a href="#jphide" aria-label="jphide">jphide</a></li>
                    <li>
                        <a href="#f5" aria-label="F5">F5</a></li>
                    <li>
                        <a href="#outguess" aria-label="outguess">outguess</a></li>
                    <li>
                        <a href="#%e7%9b%b2%e6%b0%b4%e5%8d%b0" aria-label="盲水印">盲水印</a></li>
                    <li>
                        <a href="#%e5%bc%82%e6%88%96" aria-label="异或">异或</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%bd%9c%e5%9b%be%e9%a2%98" aria-label="作图题">作图题</a><ul>
                            
                    <li>
                        <a href="#%e6%8b%bc%e5%9b%be" aria-label="拼图">拼图</a></li></ul>
                    </li>
                    <li>
                        <a href="#stegdetect-win" aria-label="stegdetect (win)">stegdetect (win)</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

        <div class="post-content"><p>师傅</p>
<p>[挺好的]http://www.ga1axy.top/index.php/archives/6/#0x01%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3</p>
<h2 id="图片隐写术">图片隐写术<a hidden class="anchor" aria-hidden="true" href="#图片隐写术">#</a></h2>
<h3 id="元数据隐写">元数据隐写<a hidden class="anchor" aria-hidden="true" href="#元数据隐写">#</a></h3>
<p>隐藏在图片的属性中，一般直接属性查看，或者用命令</p>
<p>strings：打印可直接打印的字符，可以发现隐藏的压缩包注释内容或者解压密码</p>
<p>inentify：用于获取一个或多个图像文件的格式和特征，用于提取指定数据</p>
<h4 id="png图片">png图片<a hidden class="anchor" aria-hidden="true" href="#png图片">#</a></h4>
<p><strong>文件格式</strong>：文件头固定，剩下的有数据块组成</p>
<p><strong>文件头</strong>：89 50 4E 47 0D 0A 1A 0A + 数据块 + 数据块 + 数据块</p>
<h5 id="ihdr">IHDR<a hidden class="anchor" aria-hidden="true" href="#ihdr">#</a></h5>
<p>文件头数据块，包含png图片的基本信息，由13个字节组成，只需要关注前八个字节包含宽和高</p>
<p>经常会通过更改一张图片的高和宽来隐藏一些信息</p>
<p>kali一般会打不开，提示文件错误，而在windows中可以打开，一般是修改了宽和高</p>
<h6 id="wp">wp<a hidden class="anchor" aria-hidden="true" href="#wp">#</a></h6>
<h5 id="idat图像数据块"><strong>IDAT（图像数据块）</strong><a hidden class="anchor" aria-hidden="true" href="#idat图像数据块">#</a></h5>
<h2 id="idat隐写">IDAT隐写<a hidden class="anchor" aria-hidden="true" href="#idat隐写">#</a></h2>
<ol>
<li>使用pngcheck分析 pngcheck.exe -v file</li>
<li>判断异常IDAT串，使用winhex等工具创建新文件</li>
<li>根据创建后的新文件继续分析</li>
</ol>
<ul>
<li></li>
</ul>
<p>IDAT：存储实际的数据，在数据流中可包含多个连续顺序的图像数据块。</p>
<ul>
<li>储存图像像数数据。</li>
<li>在数据流中可包含多个连续顺序的图像数据块。</li>
<li>采用 LZ77 算法的派生算法进行压缩。</li>
<li>可以用 zlib 解压缩。</li>
</ul>
<p>*** IDAT块只有当上一个块充满时，才会继续下一个新块。***</p>
<h5 id="iend"><strong>IEND</strong><a hidden class="anchor" aria-hidden="true" href="#iend">#</a></h5>
<p>图像结束数据 IEND（image trailer chunk）：它用来标记 PNG 文件或者数据流已经结束，并且必须要放在文件的尾部。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>00 00 00 00 49 45 4E 44 AE 42 60 82
</span></span></code></pre></div><p>END 数据块的长度总是 00 00 00 00 ，数据标识总是 IEND 49 45 4E 44，因此，CRC 码也总是 AE 42 60 82。</p>
<h4 id="lsb隐写">lsb隐写<a hidden class="anchor" aria-hidden="true" href="#lsb隐写">#</a></h4>
<p>LSB隐写，也就是最低有效位，图片中的像数一般是由三原色组成，这三原色也可以组成别的颜色。在png图片的存储中，每个颜色会有8bit，LSB隐写就是修改像数中最低的1bit，写入加密信息</p>
<p>三原色为红蓝绿，每个颜色的二进制都为八位，那么转化为十进制就有256种，这三种的随机组合就有256的三次方，达到了很多位，正常眼睛就无法识别，那么就可以修改最低的二进制位然后来隐藏信息，最多可以隐藏3bit的信息而使图片没有变化(人眼无法识别)</p>
<p><img loading="lazy" src="/img/13.png" alt="img"  />
</p>
<p>上图我们可以看到，十进制的235表示的是绿色，我们修改了在二进制中的最低位，但是颜色看起来依旧没有变化。我们就可以修改最低位中的信息，实现信息的隐写。我修改最低有效位的信息的算法就叫做lsb加密算法，提取最低有效位信息的算法叫做lsb解密算法</p>
<p><img loading="lazy" src="/img/123.png" alt="img"  />
</p>
<p><img loading="lazy" src="/img/32.png" alt="img"  />
</p>
<h2 id="jpg">jpg<a hidden class="anchor" aria-hidden="true" href="#jpg">#</a></h2>
<h3 id="jphide">jphide<a hidden class="anchor" aria-hidden="true" href="#jphide">#</a></h3>
<h3 id="f5">F5<a hidden class="anchor" aria-hidden="true" href="#f5">#</a></h3>
<h3 id="outguess">outguess<a hidden class="anchor" aria-hidden="true" href="#outguess">#</a></h3>
<h3 id="盲水印">盲水印<a hidden class="anchor" aria-hidden="true" href="#盲水印">#</a></h3>
<p><strong>相同的图片</strong>是异或或者盲水印，还有<strong>酷似的二维码</strong>。</p>
<h3 id="异或">异或<a hidden class="anchor" aria-hidden="true" href="#异或">#</a></h3>
<h2 id="作图题">作图题<a hidden class="anchor" aria-hidden="true" href="#作图题">#</a></h2>
<p>出现大量的010100，可能是二维码</p>
<p>或者有很多的坐标，需要用到绘制，可以使用脚本。一般出现在gif和apng中，这类分离之后，会出现数据，或者在010中可以寻找到x，y。</p>
<h3 id="拼图">拼图<a hidden class="anchor" aria-hidden="true" href="#拼图">#</a></h3>
<p>有一张打乱的图，还有一张原图，打乱的图里面可能包含着flag，使用gaps</p>
<h2 id="stegdetect-win">stegdetect (win)<a hidden class="anchor" aria-hidden="true" href="#stegdetect-win">#</a></h2>
<p>（检查jpg图片隐写方法,Stegdetect可以检测到通过JSteg、JPHide、OutGuess、Invisible Secrets、F5、appendX和Camouflage等这些隐写工具隐藏的信息）将图片复制到 stegdetect.exe 所在文件夹，打开 cmd 输入：</p>
<blockquote>
<p>stegdetect.exe -tjopi -s 10.0 [stego_file]<br>
-s 修改检测算法的敏感度，该值的默认值为1。检测结果的匹配度与检测算法的敏感度成正比，算法敏感度的值越大，检测出的可疑文件包含敏感信息的可能性越大。
-t 设置要检测哪些隐写工具（默认检测jopi），可设置的选项如下：
j检测图像中的信息是否是用jsteg嵌入的。
o 检测图像中的信息是否是用outguess嵌入的。
p 检测图像中的信息是否是用jphide嵌入的。
i 检测图像中的信息是否是用invisible secrets嵌入的</p>
</blockquote>
<p>steghide(win)</p>
<p>查看图片中嵌入的文件信息：</p>
<blockquote>
<p>steghide info out.jpg</p>
</blockquote>
<p>提取含有密码的隐藏内容：</p>
<blockquote>
<p>steghide extract -sf out.jpg -p 123456</p>
</blockquote>
<p>提取不含有密码的隐藏内容：</p>
<blockquote>
<p>steghide extract -sf out.jpg</p>
</blockquote>
<p>steghide爆破密码</p>
<p>有些题目用steghide加密文件但是不给密码，此时就需要爆破，steghide本身并不支持爆破，需要一些其他的方法： <a href="https://github.com/Va5c0/Steghide-Brute-Force-Toolpython">https://github.com/Va5c0/Steghide-Brute-Force-Toolpython</a></p>
<blockquote>
<p>steg_brute.py -b -d [字典] -f [jpg_file]</p>
</blockquote>
<p>F5</p>
<p>(F5隐写，需要passwd）</p>
<p>在kail下切换到F5-steganography，在java Extract运行命令：</p>
<blockquote>
<p>java Extract 123456.jpg图片的绝对地址 -p 123456</p>
</blockquote>
<p>outguess</p>
<p>(kali下图片隐写+可需要可不要passwd）</p>
<blockquote>
<p>outguess -r /root/angrybird.jpg(绝对路径) 123.txt(信息存放的文本)
outguess -k 12345 -r 2.jpg out.txt -k后接密码 -r后接解密图片 输出文件</p>
</blockquote>


        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://modesty258.github.io/posts/misc/wp/">
    <span class="title">« 上一页</span>
    <br>
    <span>Wp</span>
  </a>
  <a class="next" href="https://modesty258.github.io/posts/misc/%E6%96%87%E4%BB%B6%E5%A4%B4/">
    <span class="title">下一页 »</span>
    <br>
    <span>文件头</span>
  </a>
</nav>

        </footer>
    </div>

<style>
    .comments_details summary::marker {
        font-size: 20px;
        content: '👉展开评论';
        color: var(--content);
    }
    .comments_details[open] summary::marker{
        font-size: 20px;
        content: '👇关闭评论';
        color: var(--content);
    }
</style>


<div>
    <details class="comments_details">
        <summary style="cursor: pointer; margin: 50px 0 20px 0;width: 130px;">
            <span style="font-size: 20px;color: var(--content);">...</span>
        </summary>
        <div id="tcomment"></div>
    </details>
    <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js">
    </script>
    <script>
        twikoo.init({
            envId:  null ,
        el: "#tcomment",
            lang: 'zh-CN',
            region:  null ,
        path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        })
    </script>
</div>
</article>
</main>

<footer class="footer">
    <span>
        Copyright
        &copy;
        2020-2023
        <a href="https://modesty258.github.io/" style="color:#939393;">Modest&#39;s Blog</a>
        All Rights Reserved
    </span>
    <a href="https://beian.miit.gov.cn/" target="_blank" style="color:#939393;"></a>&nbsp;
    <span>
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null"
           style="display:inline-block;text-decoration:none;height:20px;color:#939393;">
            <img src="" style="float:left;margin: 0px 5px 0px 0px;"/>
            
        </a>
    </span>
    <span id="busuanzi_container">
        <span class="fa fa-user"></span> <span id="busuanzi_value_site_uv"></span>
        <span class="fa fa-eye"></span> <span id="busuanzi_value_site_pv"></span>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"Modest's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"Modest's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = '📄复制';

        function copyingDone() {
            copybutton.innerText = '👌🏻已复制!';
            setTimeout(() => {
                copybutton.innerText = '📄复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\n————————————————\r\n' +
                    '版权声明：本文为「'+"Modest's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>

<script>
    $("code[class^=language] ").on("mouseover", function () {
        if (this.clientWidth < this.scrollWidth) {
            $(this).css("width", "135%")
            $(this).css("border-top-right-radius", "var(--radius)")
        }
    }).on("mouseout", function () {
        $(this).css("width", "100%")
        $(this).css("border-top-right-radius", "unset")
    })
</script>
</body>

</html>
